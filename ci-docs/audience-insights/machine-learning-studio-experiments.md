---
title: Експерименти студії машинного навчання (класична версія)
description: Використання моделей студії машинного навчання (класична версія) у Dynamics 365 Customer Insights.
ms.date: 12/03/2020
ms.service: customer-insights
ms.subservice: audience-insights
ms.topic: tutorial
author: m-hartmann
ms.author: ameetj
ms.reviewer: mhart
manager: shellyha
ms.openlocfilehash: 2eb44604e72b32292f971754d4f8c4fd1988c697
ms.sourcegitcommit: dab2cbf818fafc9436e685376df94c5e44e4b144
ms.translationtype: HT
ms.contentlocale: uk-UA
ms.lasthandoff: 07/13/2021
ms.locfileid: "6555194"
---
# <a name="use-models-based-on-azure-machine-learning-studio-classic"></a>Використання моделей на основі студії машинного навчання Azure (класична версія).

Уніфіковані дані у програмі Dynamics 365 Customer Insights є джерелом для створення моделей машинного навчання, які можуть створювати додаткові аналітичні огляди бізнес-компаній. Customer Insights інтегрується зі студією машинного навчання (класична версія) для використання власних настроюваних моделей. Щоб побачити, як моделі, розроблені в машинному навчанні Azure, інтегровані в Customer Insights, див. розділ [Експерименти машинного навчання Azure](azure-machine-learning-experiments.md).

## <a name="prerequisites"></a>Вимоги

- Доступ до Customer Insights.
- Чинна передплата Azure Enterprise.
- [Уніфіковані профілі клієнтів](data-unification.md)
- Налаштування параметра [Експорт сутності до сховища Azure Blob](export-azure-blob-storage.md).

## <a name="set-up-machine-learning-studio-classic"></a>Налаштування класичної версії студії машинного навчання

На першому етапі потрібно створити робочу область і відкрити студію машинного навчання (класична версія).

1. Перейдіть за посиланням[https://www.portal.azure.com](https://www.portal.azure.com/) і увійдіть.

1. Виберіть **Створити ресурс**.

1. Знайдіть **Робоча область студії служб машинного навчання** й натисніть **Створити**.

1. Введіть необхідну інформацію, щоб [створити робочу область](/azure/machine-learning/studio/create-workspace). Виберіть **Рівень ціноутворення плану веб-служби** залежно від обсягу даних, які планується імпортувати. Щоб отримати максимальну швидкодію, виберіть **Розташування**, найближче до вас.

1. Після створення ресурсу відобразиться приладна дошка робочої області студії служб машинного навчання. Виберіть **Запустити студію служб машинного навчання**.

   ![Інтерфейс користувача студії служб машинного навчання Azure.](media/azure-machine-learning-studio.png)

## <a name="work-with-azure-machine-learning-studio"></a>Робота зі студією служб машинного навчання Azure

Тепер можна створити новий експеримент або імпортувати наявний шаблон експерименту з галереї прикладів. Існує кілька прикладів експериментів для трьох стандартних сценаріїв:

- [Прогноз відтоку](#churn-analysis)

- [Тривалість існування клієнта](#customer-lifetime-value-prediction)

- [Рекомендація продукту або наступна найкраща дія](#productrecommendation-or-next-best-action)

1. У разі створення нового експерименту або використання шаблону експерименту з галереї потрібно настроїти властивості **імпорту даних**. Скористайтеся керованими даними або безпосередньо надайте інформацію для доступу до сховища BLOB-об'єктів Azure, які містять дані.  

   ![Експеримент зі студією служб машинного навчання Azure.](media/azure-machine-learning-studio-experiment.png)

1. Тепер можна створити настроюваний канал обробки для очищення й попередньої обробки даних, видобування функцій і підготовки відповідної моделі.

1. Перевіряйте й оптимізуйте швидкодію моделі.

1. Якщо ви задоволені якістю моделі, виберіть **Налаштування веб-служби** > **Прогнозована веб-служба**. Цей параметр імпортує підготовлену модель і канал фічеризації з навчального експерименту до прогнозованого обслуговування. Щоб робити прогнози, прогнозоване обслуговування може використовувати ще один набір вхідних даних зі схемою, яка використовувалася в навчальному експерименті.

   ![Налаштування прогнозованої веб-служби.](media/predictive-webservice-control.png)

1. Після успішного створення експерименту прогнозованої веб-служби його можна розгорнути для автоматичного планування. Щоб веб-служба працювала з Customer Insights, виберіть **Розгорнути веб-службу** > **Підготовча версія розгортання веб-служби [нова]**. [Докладніше про розгортання веб-служби](/azure/machine-learning/studio/deploy-a-machine-learning-web-service).

   ![Розгортання прогнозованої веб-служби.](media/predictive-webservice-deploy.png)

## <a name="sample-models-from-the-gallery"></a>Приклади моделей з галереї

Для моделей, описаних у цій статті, ми використовуватимемо вигаданий сценарій Contoso Hotel. Contoso Hotel збирає наведені дані:

- Дані CRM, що містять відомості про перебування в готелі. Набір даних містить інформацію про дати перебування для кожного зареєстрованого клієнта. Він також містить інформацію про бронювання, типи номерів, відомості про витрати тощо. Дані взято за чотири роки, із січня 2014 р. по січень 2018 р.
- Профілі клієнтів для гостей готелю. Ці профілі містять інформацію про кожного клієнта, зокрема ім’я, дату народження, поштову адресу, стать і номер телефону.
- Використання послуг, які пропонує готель, наприклад спа-центр, пральня, Wi-Fi або кур’єр. Ця інформація записується для кожного зареєстрованого клієнта. Зазвичай використання послуг пов’язане з перебуванням. У деяких випадках клієнти можуть використовувати послуги, не проживаючи в готелі.

## <a name="churn-analysis"></a>Аналіз відтоку

Аналіз відтоку застосовується в різних сферах бізнесу. У цьому прикладі розглянемо відтік у зв’язку з обслуговуванням, зокрема в контексті готельних послуг, як описано вище. Цей аналіз містить робочий приклад каналу комплексної моделі, який можна взяти за початкову точку для будь-якого іншого типу моделі відтоку.

### <a name="definition-of-churn"></a>Визначення відтоку

Визначення відтоку може відрізнятися залежно від сценарію. У цьому прикладі гість, який не відвідав готель минулого року, вважатиметься втраченим клієнтом.  

Шаблон експерименту можна імпортувати з галереї. Спочатку переконайтеся, що ви імпортуєте дані для елементів **Перебування в готелі**, **Дані клієнта** та **Дані про використання послуг** зі сховища BLOB-об’єктів Azure.

   ![Імпорт даних для моделі відтоку.](media/import-data-azure-blob-storage.png)

### <a name="featurization"></a>Фічеризація

Залежно від визначення відтоку, спочатку слід визначити необроблені функції, які впливатимуть на підпис. Потім потрібно перетворити ці необроблені функції на числові, які можна буде використовувати з моделями машинного навчання. Інтеграція даних відбувається в Customer Insights, щоб ми могли приєднатися до цих таблиць за допомогою *ідентифікатора клієнта*.

   ![Об’єднання імпортованих даних.](media/join-imported-data.png)

Фічеризація для створення моделі для аналізу відтоку може видатися непростою. Дані – це функція часу з новою діяльністю готелю, що записується щодня. Під час фічеризації ми прагнемо створити статичні функції з динамічних даних. У цьому випадку ми створюємо багато функцій з діяльності готелю з рухомим вікном за один рік. Крім того, ми розширюємо функції категорій, наприклад тип номера або тип резервування, створюючи окремі функції за допомогою прямого кодування.  

Кінцевий список функцій:

| **Число**  | **Original_Column**          | **Похідні функції**                                                                                                                      |
|-------------|------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|
| 1           | Тип номера                    | RoomTypeLargeCount, RoomTypeSmallCount                                                                                                    |
| 2           | Тип резервування                 | BookingTypeOnlineCount, BookingTypePhoneCallCount                                                                                         |
| 3           | Категорія подорожі              | TravelCategoryBusinessCount, TravelCategoryLeisureCount                                                                                   |
| 4           | Сума витрачених коштів                | TotalDollarSpent                                                                                                                          |
| 5           | Дати заїзду та виїзду  | StayDayCount, StayDayCount2016, StayDayCount2015, StayDayCount2014, StayCount, StayCount2016. StayCount2015, StayCount2014                |
| 6           | Використання послуг                | UsageTenure, ConciergeUsage, CourierUsage, DryCleaningUsage, GymUsage, PhoneUsage, RestaurantUsage, SpaUsage, TelevisionUsage, WifiUsage  |

### <a name="model-selection"></a>Вибір моделі

Тепер потрібно вибрати оптимальний алгоритм для використання. У цьому випадку більшість функцій базуються на функціях категорій. Зазвичай добре працюють моделі рішення на основі дерева. Якщо існують лише числові функції, краще вибрати нейронні мережі. У таких ситуаціях також підійде машина опорних векторів (SVM). Однак для хорошої продуктивності вона потребує багато настройок. Для першої моделі виберемо **Дерево рішень, побудоване методом градієнтного зростання**, а для другої – **Двокласова SVM**. Студія служб машинного навчання Azure дає змогу виконувати А/Б тестування, тому варто починати з двох моделей, а не з однієї.

На зображенні нижче показано модель навчання та канал оцінки зі студії служб машинного навчання Azure:

![Модель відтоку в студії служб машинного навчання Azure.](media/azure-machine-learning-model.png)

Ми також застосовуємо методику, яка називається **Важливість функції перестановки** та є важливим аспектом оптимізації моделі. Убудовані моделі практично не мають відомостей про вплив будь-якої певної функції на кінцевий прогноз. Калькулятор важливості функції використовує настроюваний алгоритм для обчислення впливу окремих функцій на результат для певної моделі. Важливість функції оцінюється від +1 до -1. Негативний вплив означає, що відповідна функція має парадоксальний вплив на результат і її слід видалити з моделі. Позитивний вплив указує на те, що ця функція значною мірою сприяє прогнозуванню. Ці значення не є коефіцієнтами кореляції, оскільки вони відрізняються за показниками. Щоб отримати додаткові відомості, див. розділ [Важливість функції перестановки](/azure/machine-learning/studio-module-reference/permutation-feature-importance).

Увесь [експеримент з відтоку доступний у галереї штучного інтелекту Azure](https://gallery.azure.ai/Experiment/Hotel-Churn-Predictive-Exp).

## <a name="customer-lifetime-value-prediction"></a>Прогноз тривалості існування клієнта

Обчислення тривалості існування клієнта (CLTV) – це один із ключових показників, які компанія може використовувати для оцінки та сегментації клієнтів. Для готельного бізнесу важливо знати своїх клієнтів. Наприклад, розуміння факторів, які сприяють залученню хороших клієнтів, є надзвичайно важливим. Це допомагає керівництву готелю оцінити, на яких функціях варто зосередити увагу, щоб покращити їх і задовольнити вимоги клієнтів, що сплачують значні кошти. Ці рішення можуть мати безпосередній вплив на збут і заробіток.  

### <a name="definition-of-cltv"></a>Визначення CLTV

Для цього прикладу визначимо CLTV клієнта як загальну суму коштів клієнта, яку він має витратити в найближчі 365 днів. Щоб визначити цей показник, використаємо дані всіх клієнтів за останні три роки.

### <a name="featurization"></a>Фічеризація

У цьому випадку фічеризація буде дуже схожою на сценарій відтоку. Проте підписи й прогнозовані значення відрізняються від зазначених вище.

### <a name="model-selection"></a>Вибір моделі

Прогнозування CLTV – це проблема регресії, оскільки прогнозоване значення є безперервною змінною з додатним значенням. Залежно від властивостей функції, виберемо **Регресія дерева рішень, побудованого методом зростання** як один алгоритм і **Регресія нейронної мережі** як інший алгоритм для навчання моделі.

## <a name="product-recommendation-or-next-best-action"></a>Рекомендація продукту або наступна найкраща дія

Під рекомендацією продукту в готельному сценарії розуміються рекомендовані послуги, які пропонуються готелем клієнтам. Ціль – вибрати відповідні послуги для клієнтів, щоб максимально збільшити їх використання. Вона подібна до рекомендацій щодо фільмів для користувачів служби потокового відео.

### <a name="definition-of-product-recommendation-or-next-best-action"></a>Визначення рекомендації продукту або наступна найкраща дія

Ми визначаємо ціль як максимальне збільшення суми коштів за використання послуг, пропонуючи клієнтам готелю послуги найкращої відповідності згідно з їхніми уподобаннями.

### <a name="featurization"></a>Фічеризація

Подібно до моделі відтоку, ми об’єднуємо ServiceCustomerID готелю з CustomerID, щоб постійно створювати рекомендації для CustomerID.

![Фічеризація моделі рекомендацій.](media/azure-machine-learning-model-featurization.png)

Дані отримуються з трьох різних сутностей, а функції успадковуються від них. Фічеризація для проблеми рекомендації відрізняється порівняно зі сценаріями відтоку або CLTV. Модель рекомендацій потребує введення даних у форму з трьох наборів функцій.

### <a name="model-selection"></a>Вибір моделі

Ми прогнозуємо продукти або послуги за допомогою алгоритму **Постачальник рекомендацій Train Matchbox** для підготовки моделі рекомендацій.

![Алгоритм рекомендацій продуктів.](media/azure-machine-learning-model-recommendation-algorithm.png)

Три порти вводу для моделі **Постачальник рекомендацій Train Matchbox** включають дані про використання навчальних послуг, опис клієнта (необов’язково) й опис послуги. Існує три різних способи оцінювання моделі. Один для оцінки моделі, в якому визначається показник нормалізованого дисконтованого сукупного приросту (NDCG) для ранжирування оцінюваних елементів. У цьому експерименті показник NDCG становить 0,97. Два інші варіанти – це оцінювання моделі для всього каталогу рекомендованих послуг або оцінювання лише тих елементів, які користувачі раніше не використовували.

Крім того, розглянувши розподіл рекомендацій щодо каталогу всіх послуг, ми помітили, що телефон, Wi-Fi і кур’єр є основними послугами, які слід рекомендувати. Це узгоджується з тим, що було отримано в розподілах даних про використання послуг:

![Результат моделі рекомендацій.](media/azure-machine-learning-model-output.png)

Увесь [експеримент із рекомендацій продукту доступний у галереї штучного інтелекту Azure.](https://gallery.azure.ai/Experiment/Recommendation-4)

## <a name="integrate-custom-models"></a>Інтеграція користувацьких моделей

Щоб використовувати ці прогнози в Customer Insights, потрібно **експортувати** прогнози разом з ідентифікаторами клієнтів. [Експортуйте їх до того самого розташування сховища Blob-даних Azure](/azure/storage/common/storage-import-export-data-from-blobs), до якому буде експортуватися вихідні дані. Можна запланувати, щоб прогнозована веб-служба регулярно запускалася й оновлювала показники.

Дані, створені настроюваними моделями, можна використовувати для подальшого збагачення даних клієнтів. Додаткові відомості див. в розділі [Настроювані моделі машинного навчання](custom-models.md).


[!INCLUDE[footer-include](../includes/footer-banner.md)]