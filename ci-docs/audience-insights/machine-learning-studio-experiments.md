---
title: Експерименти студії машинного навчання (класична версія)
description: Використання моделей студії машинного навчання (класична версія) у Dynamics 365 Customer Insights.
ms.date: 12/03/2020
ms.service: customer-insights
ms.subservice: audience-insights
ms.topic: conceptual
author: m-hartmann
ms.author: mhart
ms.reviewer: ameetj
manager: shellyha
ms.openlocfilehash: 556b6810db0ed2733a3f086291757bd85b77e371
ms.sourcegitcommit: a9b2cf598f256d07a48bba8617347ee90024a1dd
ms.translationtype: HT
ms.contentlocale: uk-UA
ms.lasthandoff: 12/03/2020
ms.locfileid: "4669043"
---
# <a name="use-models-based-on-azure-machine-learning-studio-classic"></a><span data-ttu-id="65d2a-103">Використання моделей на основі студії машинного навчання Azure (класична версія).</span><span class="sxs-lookup"><span data-stu-id="65d2a-103">Use models based on Azure Machine Learning Studio (classic)</span></span>

<span data-ttu-id="65d2a-104">Уніфіковані дані у програмі Dynamics 365 Customer Insights є джерелом для створення моделей машинного навчання, які можуть створювати додаткові аналітичні огляди бізнес-компаній.</span><span class="sxs-lookup"><span data-stu-id="65d2a-104">The unified data in Dynamics 365 Customer Insights is a source for building machine learning models that can generate additional business insights.</span></span> <span data-ttu-id="65d2a-105">Customer Insights інтегрується зі студією машинного навчання (класична версія) для використання власних настроюваних моделей.</span><span class="sxs-lookup"><span data-stu-id="65d2a-105">Customer Insights integrates with Machine Learning Studio (classic) to use your own custom models.</span></span> <span data-ttu-id="65d2a-106">Щоб побачити, як моделі, розроблені в машинному навчанні Azure, інтегровані в Customer Insights, див. розділ [Експерименти машинного навчання Azure](azure-machine-learning-experiments.md).</span><span class="sxs-lookup"><span data-stu-id="65d2a-106">To see how models developed in Azure Machine Learning are integrated with Customer Insights, see [Azure Machine Learning experiments](azure-machine-learning-experiments.md).</span></span>

## <a name="prerequisites"></a><span data-ttu-id="65d2a-107">Вимоги</span><span class="sxs-lookup"><span data-stu-id="65d2a-107">Prerequisites</span></span>

- <span data-ttu-id="65d2a-108">Доступ до Customer Insights.</span><span class="sxs-lookup"><span data-stu-id="65d2a-108">Access to Customer Insights</span></span>
- <span data-ttu-id="65d2a-109">Чинна передплата Azure Enterprise.</span><span class="sxs-lookup"><span data-stu-id="65d2a-109">Active Azure Enterprise subscription</span></span>
- [<span data-ttu-id="65d2a-110">Уніфіковані профілі клієнтів</span><span class="sxs-lookup"><span data-stu-id="65d2a-110">Unified customer profiles</span></span>](data-unification.md)
- <span data-ttu-id="65d2a-111">Налаштування параметра [Експорт сутності до сховища Azure Blob](export-azure-blob-storage.md).</span><span class="sxs-lookup"><span data-stu-id="65d2a-111">[Entity export to Azure Blob storage](export-azure-blob-storage.md) set up</span></span>

## <a name="set-up-machine-learning-studio-classic"></a><span data-ttu-id="65d2a-112">Налаштування класичної версії студії машинного навчання</span><span class="sxs-lookup"><span data-stu-id="65d2a-112">Set up Machine Learning Studio Classic</span></span>

<span data-ttu-id="65d2a-113">На першому етапі потрібно створити робочу область і відкрити студію машинного навчання (класична версія).</span><span class="sxs-lookup"><span data-stu-id="65d2a-113">In a first step, we need to create a workspace for and open the Machine Learning Studio (classic).</span></span>

1. <span data-ttu-id="65d2a-114">Перейдіть за посиланням[https://www.portal.azure.com](https://www.portal.azure.com/) і увійдіть.</span><span class="sxs-lookup"><span data-stu-id="65d2a-114">Go to [https://www.portal.azure.com](https://www.portal.azure.com/) and sign in.</span></span>

1. <span data-ttu-id="65d2a-115">Виберіть **Створити ресурс**.</span><span class="sxs-lookup"><span data-stu-id="65d2a-115">Select **Create a resource**.</span></span>

1. <span data-ttu-id="65d2a-116">Знайдіть **Робоча область студії служб машинного навчання** й натисніть **Створити**.</span><span class="sxs-lookup"><span data-stu-id="65d2a-116">Search **Machine Learning Studio Workspace** and select **Create**.</span></span>

1. <span data-ttu-id="65d2a-117">Введіть необхідну інформацію, щоб [створити робочу область](https://docs.microsoft.com/azure/machine-learning/studio/create-workspace).</span><span class="sxs-lookup"><span data-stu-id="65d2a-117">Enter the required details to [create the workspace](https://docs.microsoft.com/azure/machine-learning/studio/create-workspace).</span></span> <span data-ttu-id="65d2a-118">Виберіть **Рівень ціноутворення плану веб-служби** залежно від обсягу даних, які планується імпортувати.</span><span class="sxs-lookup"><span data-stu-id="65d2a-118">Choose the **Web service plan pricing tier** based on the amount of data you plan to import.</span></span> <span data-ttu-id="65d2a-119">Щоб отримати максимальну швидкодію, виберіть **Розташування**, найближче до вас.</span><span class="sxs-lookup"><span data-stu-id="65d2a-119">For best performance, select the **Location** that is geographically closest to you.</span></span>

1. <span data-ttu-id="65d2a-120">Після створення ресурсу відобразиться приладна дошка робочої області студії служб машинного навчання.</span><span class="sxs-lookup"><span data-stu-id="65d2a-120">After creating the resource, the Machine Learning Studio workspace dashboard will appear.</span></span> <span data-ttu-id="65d2a-121">Виберіть **Запустити студію служб машинного навчання**.</span><span class="sxs-lookup"><span data-stu-id="65d2a-121">Select **Launch Machine Learning Studio**.</span></span>

   ![Інтерфейс користувача студії служб машинного навчання Azure](media/azure-machine-learning-studio.png)

## <a name="work-with-azure-machine-learning-studio"></a><span data-ttu-id="65d2a-123">Робота зі студією служб машинного навчання Azure</span><span class="sxs-lookup"><span data-stu-id="65d2a-123">Work with Azure Machine Learning Studio</span></span>

<span data-ttu-id="65d2a-124">Тепер можна створити новий експеримент або імпортувати наявний шаблон експерименту з галереї прикладів.</span><span class="sxs-lookup"><span data-stu-id="65d2a-124">You can now create a new experiment, or import an existing experiment template from the sample gallery.</span></span> <span data-ttu-id="65d2a-125">Існує кілька прикладів експериментів для трьох стандартних сценаріїв:</span><span class="sxs-lookup"><span data-stu-id="65d2a-125">There are sample experiments for three standard scenarios:</span></span>

- [<span data-ttu-id="65d2a-126">Прогноз відтоку</span><span class="sxs-lookup"><span data-stu-id="65d2a-126">Churn prediction</span></span>](#churn-analysis)

- [<span data-ttu-id="65d2a-127">Тривалість існування клієнта</span><span class="sxs-lookup"><span data-stu-id="65d2a-127">Customer lifetime value</span></span>](#customer-lifetime-value-prediction)

- [<span data-ttu-id="65d2a-128">Рекомендація продукту або наступна найкраща дія</span><span class="sxs-lookup"><span data-stu-id="65d2a-128">Product recommendation or next best action</span></span>](#productrecommendation-or-next-best-action)

1. <span data-ttu-id="65d2a-129">У разі створення нового експерименту або використання шаблону експерименту з галереї потрібно настроїти властивості **імпорту даних**.</span><span class="sxs-lookup"><span data-stu-id="65d2a-129">If you create a new experiment or use an experiment template from the gallery, you need to configure the **Import Data** properties.</span></span> <span data-ttu-id="65d2a-130">Скористайтеся керованими даними або безпосередньо надайте інформацію для доступу до сховища BLOB-об'єктів Azure, які містять дані.</span><span class="sxs-lookup"><span data-stu-id="65d2a-130">Use the guided experience or directly provide details to access the Azure Blob Storage that contains your data.</span></span>  

   ![Експеримент зі студією служб машинного навчання Azure](media/azure-machine-learning-studio-experiment.png)

1. <span data-ttu-id="65d2a-132">Тепер можна створити настроюваний канал обробки для очищення й попередньої обробки даних, видобування функцій і підготовки відповідної моделі.</span><span class="sxs-lookup"><span data-stu-id="65d2a-132">Now you can build a custom processing pipeline to clean and preprocess the data, extract features, and train a suitable model.</span></span>

1. <span data-ttu-id="65d2a-133">Перевіряйте й оптимізуйте швидкодію моделі.</span><span class="sxs-lookup"><span data-stu-id="65d2a-133">Test and optimize the model performance.</span></span>

1. <span data-ttu-id="65d2a-134">Якщо ви задоволені якістю моделі, виберіть **Налаштування веб-служби** > **Прогнозована веб-служба**.</span><span class="sxs-lookup"><span data-stu-id="65d2a-134">When you’re satisfied with the quality of a model, select **Set up web service** > **Predictive Web Service**.</span></span> <span data-ttu-id="65d2a-135">Цей параметр імпортує підготовлену модель і канал фічеризації з навчального експерименту до прогнозованого обслуговування.</span><span class="sxs-lookup"><span data-stu-id="65d2a-135">This option imports the trained model and the featurization pipeline from the training experiment to a predictive service.</span></span> <span data-ttu-id="65d2a-136">Щоб робити прогнози, прогнозоване обслуговування може використовувати ще один набір вхідних даних зі схемою, яка використовувалася в навчальному експерименті.</span><span class="sxs-lookup"><span data-stu-id="65d2a-136">The predictive service can take another set of input data with the schema used in the training experiment to make predictions.</span></span>

   ![Налаштування прогнозованої веб-служби](media/predictive-webservice-control.png)

1. <span data-ttu-id="65d2a-138">Після успішного створення експерименту прогнозованої веб-служби його можна розгорнути для автоматичного планування.</span><span class="sxs-lookup"><span data-stu-id="65d2a-138">Once the predictive web service experiment is successful, you can deploy it for auto scheduling.</span></span> <span data-ttu-id="65d2a-139">Щоб веб-служба працювала з Customer Insights, виберіть **Розгорнути веб-службу** > **Підготовча версія розгортання веб-служби [нова]**.</span><span class="sxs-lookup"><span data-stu-id="65d2a-139">To have the web service work with Customer Insights, select **Deploy Web Service** > **Deploy Web Service [New] Preview**.</span></span> <span data-ttu-id="65d2a-140">[Докладніше про розгортання веб-служби](https://docs.microsoft.com/azure/machine-learning/studio/deploy-a-machine-learning-web-service).</span><span class="sxs-lookup"><span data-stu-id="65d2a-140">[Learn more about deploying a web service](https://docs.microsoft.com/azure/machine-learning/studio/deploy-a-machine-learning-web-service).</span></span>

   ![Розгортання прогнозованої веб-служби](media/predictive-webservice-deploy.png)

## <a name="sample-models-from-the-gallery"></a><span data-ttu-id="65d2a-142">Приклади моделей з галереї</span><span class="sxs-lookup"><span data-stu-id="65d2a-142">Sample models from the gallery</span></span>

<span data-ttu-id="65d2a-143">Ми будемо використовувати вигаданий сценарій готелю Contoso для моделей у цій статті.</span><span class="sxs-lookup"><span data-stu-id="65d2a-143">We'll use a fictitious scenario of Contoso Hotel for the models in this article.</span></span> <span data-ttu-id="65d2a-144">Готель Contoso збирає перелічені нижче дані.</span><span class="sxs-lookup"><span data-stu-id="65d2a-144">Contoso Hotel gathers the following data:</span></span>

- <span data-ttu-id="65d2a-145">Дані CRM, що містять відомості про перебування в готелі.</span><span class="sxs-lookup"><span data-stu-id="65d2a-145">CRM data consisting of hotel stay activity.</span></span> <span data-ttu-id="65d2a-146">Набір даних містить інформацію про дати перебування для кожного зареєстрованого клієнта.</span><span class="sxs-lookup"><span data-stu-id="65d2a-146">The data set includes information about the dates of stay for each registered customer.</span></span> <span data-ttu-id="65d2a-147">Він також містить інформацію про бронювання, типи номерів, відомості про витрати тощо.</span><span class="sxs-lookup"><span data-stu-id="65d2a-147">It also contains information about the booking, room types, details of spend, and so on.</span></span> <span data-ttu-id="65d2a-148">Дані взято за чотири роки, із січня 2014 р. по січень 2018 р.</span><span class="sxs-lookup"><span data-stu-id="65d2a-148">The data spans four years, from January 2014 to January 2018.</span></span>
- <span data-ttu-id="65d2a-149">Профілі клієнтів для гостей готелю.</span><span class="sxs-lookup"><span data-stu-id="65d2a-149">Customer profiles of hotel guests.</span></span> <span data-ttu-id="65d2a-150">Ці профілі містять інформацію про кожного клієнта, зокрема ім’я, дату народження, поштову адресу, стать і номер телефону.</span><span class="sxs-lookup"><span data-stu-id="65d2a-150">These profiles contain information about each customer, including their name, birthdate, postal address, gender, and phone number.</span></span>
- <span data-ttu-id="65d2a-151">Використання послуг, які пропонує готель, наприклад спа-центр, пральня, Wi-Fi або кур’єр.</span><span class="sxs-lookup"><span data-stu-id="65d2a-151">Usage of services offered by the hotel, such as the spa, laundry, WiFi, or courier.</span></span> <span data-ttu-id="65d2a-152">Ця інформація записується для кожного зареєстрованого клієнта.</span><span class="sxs-lookup"><span data-stu-id="65d2a-152">This information is logged for each registered customer.</span></span> <span data-ttu-id="65d2a-153">Зазвичай використання послуг пов’язане з перебуванням.</span><span class="sxs-lookup"><span data-stu-id="65d2a-153">Typically, use of services is linked with the stay.</span></span> <span data-ttu-id="65d2a-154">У деяких випадках клієнти можуть використовувати послуги, не проживаючи в готелі.</span><span class="sxs-lookup"><span data-stu-id="65d2a-154">In some cases, services can be used by customers without staying in the hotel.</span></span>

## <a name="churn-analysis"></a><span data-ttu-id="65d2a-155">Аналіз відтоку</span><span class="sxs-lookup"><span data-stu-id="65d2a-155">Churn Analysis</span></span>

<span data-ttu-id="65d2a-156">Аналіз відтоку застосовується в різних сферах бізнесу.</span><span class="sxs-lookup"><span data-stu-id="65d2a-156">Churn analysis applies to different business areas.</span></span> <span data-ttu-id="65d2a-157">У цьому прикладі розглянемо відтік у зв’язку з обслуговуванням, зокрема в контексті готельних послуг, як описано вище.</span><span class="sxs-lookup"><span data-stu-id="65d2a-157">In this example, we’re going to look at service churn, specifically in the context of hotel services as described above.</span></span> <span data-ttu-id="65d2a-158">Цей аналіз містить робочий приклад каналу комплексної моделі, який можна взяти за початкову точку для будь-якого іншого типу моделі відтоку.</span><span class="sxs-lookup"><span data-stu-id="65d2a-158">It provides a working example of an end–to–end model pipeline that can be used as a starting point for any other type of churn model.</span></span>

### <a name="definition-of-churn"></a><span data-ttu-id="65d2a-159">Визначення відтоку</span><span class="sxs-lookup"><span data-stu-id="65d2a-159">Definition of Churn</span></span>

<span data-ttu-id="65d2a-160">Визначення відтоку може відрізнятися залежно від сценарію.</span><span class="sxs-lookup"><span data-stu-id="65d2a-160">The definition of churn can differ based on the scenario.</span></span> <span data-ttu-id="65d2a-161">У цьому прикладі гість, який не відвідав готель минулого року, вважатиметься втраченим клієнтом.</span><span class="sxs-lookup"><span data-stu-id="65d2a-161">In this example, a guest who hasn’t visited the hotel in the past year should be labeled as churned.</span></span>  

<span data-ttu-id="65d2a-162">Шаблон експерименту можна імпортувати з галереї.</span><span class="sxs-lookup"><span data-stu-id="65d2a-162">The experiment template can be imported from the gallery.</span></span> <span data-ttu-id="65d2a-163">Спочатку переконайтеся, що ви імпортуєте дані для елементів **Перебування в готелі**, **Дані клієнта** та **Дані про використання послуг** зі сховища BLOB-об’єктів Azure.</span><span class="sxs-lookup"><span data-stu-id="65d2a-163">First, ensure that you import the data for **Hotel Stay Activity**, **Customer data**, and **Service Usage Data** from Azure Blob storage.</span></span>

   ![Імпорт даних для моделі відтоку](media/import-data-azure-blob-storage.png)

### <a name="featurization"></a><span data-ttu-id="65d2a-165">Фічеризація</span><span class="sxs-lookup"><span data-stu-id="65d2a-165">Featurization</span></span>

<span data-ttu-id="65d2a-166">Залежно від визначення відтоку, спочатку слід визначити необроблені функції, які впливатимуть на підпис.</span><span class="sxs-lookup"><span data-stu-id="65d2a-166">Based on the definition of churn, we first identify the raw features that will influence the label.</span></span> <span data-ttu-id="65d2a-167">Потім потрібно перетворити ці необроблені функції на числові, які можна буде використовувати з моделями машинного навчання.</span><span class="sxs-lookup"><span data-stu-id="65d2a-167">Then, we process these raw features into numerical features that can be used with machine learning models.</span></span> <span data-ttu-id="65d2a-168">Інтеграція даних відбувається в Customer Insights, щоб ми могли приєднатися до цих таблиць за допомогою *ідентифікатора клієнта*.</span><span class="sxs-lookup"><span data-stu-id="65d2a-168">Data integration happens in Customer Insights so we can join these tables by using the *Customer ID*.</span></span>

   ![Об’єднання імпортованих даних](media/join-imported-data.png)

<span data-ttu-id="65d2a-170">Фічеризація для створення моделі для аналізу відтоку може видатися непростою.</span><span class="sxs-lookup"><span data-stu-id="65d2a-170">The featurization for building the model for churn analysis can be a little tricky.</span></span> <span data-ttu-id="65d2a-171">Дані – це функція часу з новою діяльністю готелю, що записується щодня.</span><span class="sxs-lookup"><span data-stu-id="65d2a-171">The data is a function of time with new hotel activity recorded on daily basis.</span></span> <span data-ttu-id="65d2a-172">Під час фічеризації ми прагнемо створити статичні функції з динамічних даних.</span><span class="sxs-lookup"><span data-stu-id="65d2a-172">During featurization, we want to generate static features from the dynamic data.</span></span> <span data-ttu-id="65d2a-173">У цьому випадку ми створюємо багато функцій з діяльності готелю з рухомим вікном за один рік.</span><span class="sxs-lookup"><span data-stu-id="65d2a-173">In this case, we generate multiple features from hotel activity with a sliding window of one year.</span></span> <span data-ttu-id="65d2a-174">Крім того, ми розширюємо функції категорій, наприклад тип номера або тип резервування, створюючи окремі функції за допомогою прямого кодування.</span><span class="sxs-lookup"><span data-stu-id="65d2a-174">We also expand the categorical features like room type or booking type into separate features using one-hot encoding.</span></span>  

<span data-ttu-id="65d2a-175">Кінцевий список функцій:</span><span class="sxs-lookup"><span data-stu-id="65d2a-175">Final list of features:</span></span>

| <span data-ttu-id="65d2a-176">**Число**</span><span class="sxs-lookup"><span data-stu-id="65d2a-176">**Number**</span></span>  | <span data-ttu-id="65d2a-177">**Original_Column**</span><span class="sxs-lookup"><span data-stu-id="65d2a-177">**Original_Column**</span></span>          | <span data-ttu-id="65d2a-178">**Похідні функції**</span><span class="sxs-lookup"><span data-stu-id="65d2a-178">**Derived Features**</span></span>                                                                                                                      |
|-------------|------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="65d2a-179">1</span><span class="sxs-lookup"><span data-stu-id="65d2a-179">1</span></span>           | <span data-ttu-id="65d2a-180">Тип номера</span><span class="sxs-lookup"><span data-stu-id="65d2a-180">Room Type</span></span>                    | <span data-ttu-id="65d2a-181">RoomTypeLargeCount, RoomTypeSmallCount</span><span class="sxs-lookup"><span data-stu-id="65d2a-181">RoomTypeLargeCount, RoomTypeSmallCount</span></span>                                                                                                    |
| <span data-ttu-id="65d2a-182">2</span><span class="sxs-lookup"><span data-stu-id="65d2a-182">2</span></span>           | <span data-ttu-id="65d2a-183">Тип резервування</span><span class="sxs-lookup"><span data-stu-id="65d2a-183">Booking Type</span></span>                 | <span data-ttu-id="65d2a-184">BookingTypeOnlineCount, BookingTypePhoneCallCount</span><span class="sxs-lookup"><span data-stu-id="65d2a-184">BookingTypeOnlineCount, BookingTypePhoneCallCount</span></span>                                                                                         |
| <span data-ttu-id="65d2a-185">3</span><span class="sxs-lookup"><span data-stu-id="65d2a-185">3</span></span>           | <span data-ttu-id="65d2a-186">Категорія подорожі</span><span class="sxs-lookup"><span data-stu-id="65d2a-186">Travel Category</span></span>              | <span data-ttu-id="65d2a-187">TravelCategoryBusinessCount, TravelCategoryLeisureCount</span><span class="sxs-lookup"><span data-stu-id="65d2a-187">TravelCategoryBusinessCount, TravelCategoryLeisureCount</span></span>                                                                                   |
| <span data-ttu-id="65d2a-188">4</span><span class="sxs-lookup"><span data-stu-id="65d2a-188">4</span></span>           | <span data-ttu-id="65d2a-189">Сума витрачених коштів</span><span class="sxs-lookup"><span data-stu-id="65d2a-189">Dollars Spent</span></span>                | <span data-ttu-id="65d2a-190">TotalDollarSpent</span><span class="sxs-lookup"><span data-stu-id="65d2a-190">TotalDollarSpent</span></span>                                                                                                                          |
| <span data-ttu-id="65d2a-191">5</span><span class="sxs-lookup"><span data-stu-id="65d2a-191">5</span></span>           | <span data-ttu-id="65d2a-192">Дати заїзду та виїзду</span><span class="sxs-lookup"><span data-stu-id="65d2a-192">Check-in and Checkout dates</span></span>  | <span data-ttu-id="65d2a-193">StayDayCount, StayDayCount2016, StayDayCount2015, StayDayCount2014, StayCount, StayCount2016.</span><span class="sxs-lookup"><span data-stu-id="65d2a-193">StayDayCount, StayDayCount2016, StayDayCount2015, StayDayCount2014, StayCount, StayCount2016.</span></span> <span data-ttu-id="65d2a-194">StayCount2015, StayCount2014</span><span class="sxs-lookup"><span data-stu-id="65d2a-194">StayCount2015, StayCount2014</span></span>                |
| <span data-ttu-id="65d2a-195">6</span><span class="sxs-lookup"><span data-stu-id="65d2a-195">6</span></span>           | <span data-ttu-id="65d2a-196">Використання послуг</span><span class="sxs-lookup"><span data-stu-id="65d2a-196">Service Usage</span></span>                | <span data-ttu-id="65d2a-197">UsageTenure, ConciergeUsage, CourierUsage, DryCleaningUsage, GymUsage, PhoneUsage, RestaurantUsage, SpaUsage, TelevisionUsage, WifiUsage</span><span class="sxs-lookup"><span data-stu-id="65d2a-197">UsageTenure, ConciergeUsage, CourierUsage, DryCleaningUsage, GymUsage, PhoneUsage, RestaurantUsage, SpaUsage, TelevisionUsage, WifiUsage</span></span>  |

### <a name="model-selection"></a><span data-ttu-id="65d2a-198">Вибір моделі</span><span class="sxs-lookup"><span data-stu-id="65d2a-198">Model selection</span></span>

<span data-ttu-id="65d2a-199">Тепер потрібно вибрати оптимальний алгоритм для використання.</span><span class="sxs-lookup"><span data-stu-id="65d2a-199">Now we need to choose the optimal algorithm to use.</span></span> <span data-ttu-id="65d2a-200">У цьому випадку більшість функцій базуються на функціях категорій.</span><span class="sxs-lookup"><span data-stu-id="65d2a-200">In this case, most features are based on categorical features.</span></span> <span data-ttu-id="65d2a-201">Зазвичай добре працюють моделі рішення на основі дерева.</span><span class="sxs-lookup"><span data-stu-id="65d2a-201">Typically, decision tree–based models work well.</span></span> <span data-ttu-id="65d2a-202">Якщо існують лише числові функції, краще вибрати нейронні мережі.</span><span class="sxs-lookup"><span data-stu-id="65d2a-202">If there are only numerical features, neural networks could be a better choice.</span></span> <span data-ttu-id="65d2a-203">У таких ситуаціях також підійде машина опорних векторів (SVM). Однак для хорошої продуктивності вона потребує багато настройок.</span><span class="sxs-lookup"><span data-stu-id="65d2a-203">Support vector machine (SVM) also is a good candidate in such situations; however, it needs quite a bit of tuning to extract the best performance.</span></span> <span data-ttu-id="65d2a-204">Для першої моделі виберемо **Дерево рішень, побудоване методом градієнтного зростання**, а для другої – **Двокласова SVM**.</span><span class="sxs-lookup"><span data-stu-id="65d2a-204">We choose **Two-Class Boosted Decision Tree** as the first model of choice followed by **Two-Class SVM** as the second model.</span></span> <span data-ttu-id="65d2a-205">Студія служб машинного навчання Azure дає змогу виконувати А/Б тестування, тому варто починати з двох моделей, а не з однієї.</span><span class="sxs-lookup"><span data-stu-id="65d2a-205">Azure Machine Learning Studio lets you do A/B testing, so it’s beneficial to start with two models rather than one.</span></span>

<span data-ttu-id="65d2a-206">На зображенні нижче показано модель навчання та канал оцінки зі студії служб машинного навчання Azure:</span><span class="sxs-lookup"><span data-stu-id="65d2a-206">The following image shows the model training and evaluation pipeline from Azure Machine Learning Studio:</span></span>

![Модель відтоку в студії служб машинного навчання Azure](media/azure-machine-learning-model.png)

<span data-ttu-id="65d2a-208">Ми також застосовуємо методику, яка називається **Важливість функції перестановки** та є важливим аспектом оптимізації моделі.</span><span class="sxs-lookup"><span data-stu-id="65d2a-208">We also apply a technique called **Permutation Feature Importance**, an important aspect of model optimization.</span></span> <span data-ttu-id="65d2a-209">Убудовані моделі практично не мають відомостей про вплив будь-якої певної функції на кінцевий прогноз.</span><span class="sxs-lookup"><span data-stu-id="65d2a-209">Built-in models have little to no insight into the impact of any specific feature on the final prediction.</span></span> <span data-ttu-id="65d2a-210">Калькулятор важливості функції використовує настроюваний алгоритм для обчислення впливу окремих функцій на результат для певної моделі.</span><span class="sxs-lookup"><span data-stu-id="65d2a-210">The feature importance calculator uses a custom algorithm to compute the influence of individual features on the outcome for a specific model.</span></span> <span data-ttu-id="65d2a-211">Важливість функції оцінюється від +1 до -1.</span><span class="sxs-lookup"><span data-stu-id="65d2a-211">The feature importance is normalized between +1 to -1.</span></span> <span data-ttu-id="65d2a-212">Негативний вплив означає, що відповідна функція має парадоксальний вплив на результат і її слід видалити з моделі.</span><span class="sxs-lookup"><span data-stu-id="65d2a-212">A negative influence means the corresponding feature has counter-intuitive influence on the outcome and should be removed from the model.</span></span> <span data-ttu-id="65d2a-213">Позитивний вплив указує на те, що ця функція значною мірою сприяє прогнозуванню.</span><span class="sxs-lookup"><span data-stu-id="65d2a-213">A positive influence indicates the feature is contributing heavily towards the prediction.</span></span> <span data-ttu-id="65d2a-214">Ці значення не є коефіцієнтами кореляції, оскільки вони відрізняються за показниками.</span><span class="sxs-lookup"><span data-stu-id="65d2a-214">These values aren't correlation coefficients as they are different metrics.</span></span> <span data-ttu-id="65d2a-215">Щоб отримати додаткові відомості, див. розділ [Важливість функції перестановки](https://docs.microsoft.com/azure/machine-learning/studio-module-reference/permutation-feature-importance).</span><span class="sxs-lookup"><span data-stu-id="65d2a-215">For more information, see [Permutation Feature Importance](https://docs.microsoft.com/azure/machine-learning/studio-module-reference/permutation-feature-importance).</span></span>

<span data-ttu-id="65d2a-216">Увесь [експеримент з відтоку доступний у галереї штучного інтелекту Azure](https://gallery.azure.ai/Experiment/Hotel-Churn-Predictive-Exp).</span><span class="sxs-lookup"><span data-stu-id="65d2a-216">The entire [churn experiment is available in the Azure AI Gallery](https://gallery.azure.ai/Experiment/Hotel-Churn-Predictive-Exp).</span></span>

## <a name="customer-lifetime-value-prediction"></a><span data-ttu-id="65d2a-217">Прогноз тривалості існування клієнта</span><span class="sxs-lookup"><span data-stu-id="65d2a-217">Customer lifetime value prediction</span></span>

<span data-ttu-id="65d2a-218">Обчислення тривалості існування клієнта (CLTV) – це один із ключових показників, які компанія може використовувати для оцінки та сегментації клієнтів.</span><span class="sxs-lookup"><span data-stu-id="65d2a-218">The customer lifetime value (CLTV) calculation is one of the key metrics that a business can use to assess and segment its customers.</span></span> <span data-ttu-id="65d2a-219">Для готельного бізнесу важливо знати своїх клієнтів.</span><span class="sxs-lookup"><span data-stu-id="65d2a-219">For the hotel business, it’s critical to know their customers.</span></span> <span data-ttu-id="65d2a-220">Наприклад, розуміння факторів, які сприяють залученню хороших клієнтів, є надзвичайно важливим.</span><span class="sxs-lookup"><span data-stu-id="65d2a-220">For example, understanding factors that make up good customers is crucial information.</span></span> <span data-ttu-id="65d2a-221">Це допомагає керівництву готелю оцінити, на яких функціях варто зосередити увагу, щоб покращити їх і задовольнити вимоги клієнтів, що сплачують значні кошти.</span><span class="sxs-lookup"><span data-stu-id="65d2a-221">It helps the hotel management assess which features they need to focus on and improve to satisfy their high paying customers.</span></span> <span data-ttu-id="65d2a-222">Ці рішення можуть мати безпосередній вплив на збут і заробіток.</span><span class="sxs-lookup"><span data-stu-id="65d2a-222">These decisions can have a direct impact on sales and earnings.</span></span>  

### <a name="definition-of-cltv"></a><span data-ttu-id="65d2a-223">Визначення CLTV</span><span class="sxs-lookup"><span data-stu-id="65d2a-223">Definition of CLTV</span></span>

<span data-ttu-id="65d2a-224">Для цього прикладу визначимо CLTV клієнта як загальну суму коштів клієнта, яку він має витратити в найближчі 365 днів.</span><span class="sxs-lookup"><span data-stu-id="65d2a-224">For this example, we define the CLTV of a customer as the total dollar amount the customer is expected to spend in the next 365 days.</span></span> <span data-ttu-id="65d2a-225">Щоб визначити цей показник, використаємо дані всіх клієнтів за останні три роки.</span><span class="sxs-lookup"><span data-stu-id="65d2a-225">We are going to use the past three years’ worth of data for all customers to predict this value.</span></span>

### <a name="featurization"></a><span data-ttu-id="65d2a-226">Фічеризація</span><span class="sxs-lookup"><span data-stu-id="65d2a-226">Featurization</span></span>

<span data-ttu-id="65d2a-227">У цьому випадку фічеризація буде дуже схожою на сценарій відтоку.</span><span class="sxs-lookup"><span data-stu-id="65d2a-227">In this case, featurization is going to be quite like the churn scenario.</span></span> <span data-ttu-id="65d2a-228">Проте підписи й прогнозовані значення відрізняються від зазначених вище.</span><span class="sxs-lookup"><span data-stu-id="65d2a-228">However, the labels and predicted values are different than defined above.</span></span>

### <a name="model-selection"></a><span data-ttu-id="65d2a-229">Вибір моделі</span><span class="sxs-lookup"><span data-stu-id="65d2a-229">Model selection</span></span>

<span data-ttu-id="65d2a-230">Прогнозування CLTV – це проблема регресії, оскільки прогнозоване значення є безперервною змінною з додатним значенням.</span><span class="sxs-lookup"><span data-stu-id="65d2a-230">Predicting the CLTV is a regression problem as the predicted value is a positive valued continuous variable.</span></span> <span data-ttu-id="65d2a-231">Залежно від властивостей функції, виберемо **Регресія дерева рішень, побудованого методом зростання** як один алгоритм і **Регресія нейронної мережі** як інший алгоритм для навчання моделі.</span><span class="sxs-lookup"><span data-stu-id="65d2a-231">Based on the feature properties, we select **Boosted Decision Tree Regression** as one algorithm and **Neural Network Regression** as another algorithm to train the model.</span></span>

## <a name="product-recommendation-or-next-best-action"></a><span data-ttu-id="65d2a-232">Рекомендація продукту або наступна найкраща дія</span><span class="sxs-lookup"><span data-stu-id="65d2a-232">Product recommendation or Next Best Action</span></span>

<span data-ttu-id="65d2a-233">Під рекомендацією продукту в готельному сценарії розуміються рекомендовані послуги, які пропонуються готелем клієнтам.</span><span class="sxs-lookup"><span data-stu-id="65d2a-233">Product recommendation in a hotel scenario is interpreted as recommending services offered by the hotel to the customers.</span></span> <span data-ttu-id="65d2a-234">Ціль – вибрати відповідні послуги для клієнтів, щоб максимально збільшити їх використання.</span><span class="sxs-lookup"><span data-stu-id="65d2a-234">The objective is to choose the appropriate services for customers so that their usage is maximized.</span></span> <span data-ttu-id="65d2a-235">Вона подібна до рекомендацій щодо фільмів для користувачів служби потокового відео.</span><span class="sxs-lookup"><span data-stu-id="65d2a-235">It’s similar to movie recommendations for video streaming service users.</span></span>

### <a name="definition-of-product-recommendation-or-next-best-action"></a><span data-ttu-id="65d2a-236">Визначення рекомендації продукту або наступна найкраща дія</span><span class="sxs-lookup"><span data-stu-id="65d2a-236">Definition of Product Recommendation or Next Best Action</span></span>

<span data-ttu-id="65d2a-237">Ми визначаємо ціль як максимальне збільшення суми коштів за використання послуг, пропонуючи клієнтам готелю послуги найкращої відповідності згідно з їхніми уподобаннями.</span><span class="sxs-lookup"><span data-stu-id="65d2a-237">We define the goal as maximizing the dollar amount of service usage by offering the best matching services to hotel customers according to their interest.</span></span>

### <a name="featurization"></a><span data-ttu-id="65d2a-238">Фічеризація</span><span class="sxs-lookup"><span data-stu-id="65d2a-238">Featurization</span></span>

<span data-ttu-id="65d2a-239">Подібно до моделі відтоку, ми об’єднуємо ServiceCustomerID готелю з CustomerID, щоб постійно створювати рекомендації для CustomerID.</span><span class="sxs-lookup"><span data-stu-id="65d2a-239">Like the churn model, we are joining the hotel ServiceCustomerID with CustomerID in order to build recommendations consistently per CustomerID.</span></span>

![Фічеризація моделі рекомендацій](media/azure-machine-learning-model-featurization.png)

<span data-ttu-id="65d2a-241">Дані отримуються з трьох різних сутностей, а функції успадковуються від них.</span><span class="sxs-lookup"><span data-stu-id="65d2a-241">The data is sourced from three different entities and features are derived from them.</span></span> <span data-ttu-id="65d2a-242">Фічеризація для проблеми рекомендації відрізняється порівняно зі сценаріями відтоку або CLTV.</span><span class="sxs-lookup"><span data-stu-id="65d2a-242">The featurization for the problem of recommendation is different compared to churn or CLTV scenarios.</span></span> <span data-ttu-id="65d2a-243">Модель рекомендацій потребує введення даних у форму з трьох наборів функцій.</span><span class="sxs-lookup"><span data-stu-id="65d2a-243">The recommendation model needs input data in the form of three sets of features.</span></span>

### <a name="model-selection"></a><span data-ttu-id="65d2a-244">Вибір моделі</span><span class="sxs-lookup"><span data-stu-id="65d2a-244">Model selection</span></span>

<span data-ttu-id="65d2a-245">Ми прогнозуємо продукти або послуги за допомогою алгоритму **Постачальник рекомендацій Train Matchbox** для підготовки моделі рекомендацій.</span><span class="sxs-lookup"><span data-stu-id="65d2a-245">We predict products or services by using the algorithm called **Train Matchbox Recommender** to train the recommendation model.</span></span>

![Алгоритм рекомендацій продуктів](media/azure-machine-learning-model-recommendation-algorithm.png)

<span data-ttu-id="65d2a-247">Три порти вводу для моделі **Постачальник рекомендацій Train Matchbox** включають дані про використання навчальних послуг, опис клієнта (необов’язково) й опис послуги.</span><span class="sxs-lookup"><span data-stu-id="65d2a-247">The three input ports for the **Train Matchbox Recommender** model takes in the training service usage data, customer description (optional), and service description.</span></span> <span data-ttu-id="65d2a-248">Існує три різних способи оцінювання моделі.</span><span class="sxs-lookup"><span data-stu-id="65d2a-248">There are three different ways of scoring the model.</span></span> <span data-ttu-id="65d2a-249">Один для оцінки моделі, в якому визначається показник нормалізованого дисконтованого сукупного приросту (NDCG) для ранжирування оцінюваних елементів.</span><span class="sxs-lookup"><span data-stu-id="65d2a-249">One is for model evaluation where a Normalized Discounted Cumulative Gain (NDCG) score is calculated to rank the rated items.</span></span> <span data-ttu-id="65d2a-250">У цьому експерименті показник NDCG становить 0,97.</span><span class="sxs-lookup"><span data-stu-id="65d2a-250">In this experiment, we have the NDCG score as 0.97.</span></span> <span data-ttu-id="65d2a-251">Два інші варіанти – це оцінювання моделі для всього каталогу рекомендованих послуг або оцінювання лише тих елементів, які користувачі раніше не використовували.</span><span class="sxs-lookup"><span data-stu-id="65d2a-251">The other two options are scoring the model on the entire recommendable service catalog, or scoring only on items that users have not used before.</span></span>

<span data-ttu-id="65d2a-252">Крім того, розглянувши розподіл рекомендацій щодо каталогу всіх послуг, ми помітили, що телефон, Wi-Fi і кур’єр є основними послугами, які слід рекомендувати.</span><span class="sxs-lookup"><span data-stu-id="65d2a-252">Looking further on the distributions of the recommendations on the entire service catalog, we notice that phone, WiFi, and courier are the top services to be recommended.</span></span> <span data-ttu-id="65d2a-253">Це узгоджується з тим, що було отримано в розподілах даних про використання послуг:</span><span class="sxs-lookup"><span data-stu-id="65d2a-253">This is consistent with what we found from the distributions of the service consumption data:</span></span>

![Результат моделі рекомендацій](media/azure-machine-learning-model-output.png)

<span data-ttu-id="65d2a-255">Увесь [експеримент із рекомендацій продукту доступний у галереї штучного інтелекту Azure.](https://gallery.azure.ai/Experiment/Recommendation-4)</span><span class="sxs-lookup"><span data-stu-id="65d2a-255">The entire [product recommendation experiment can be accessed in Azure AI Gallery.](https://gallery.azure.ai/Experiment/Recommendation-4)</span></span>

## <a name="integrate-custom-models"></a><span data-ttu-id="65d2a-256">Інтеграція користувацьких моделей</span><span class="sxs-lookup"><span data-stu-id="65d2a-256">Integrate custom models</span></span>

<span data-ttu-id="65d2a-257">Щоб використовувати ці прогнози в Customer Insights, потрібно **експортувати** прогнози разом з ідентифікаторами клієнтів.</span><span class="sxs-lookup"><span data-stu-id="65d2a-257">To use these predictions in Customer Insights, you need to **export** the predictions along with the customer IDs.</span></span> <span data-ttu-id="65d2a-258">[Експортуйте їх до того самого розташування сховища Blob-даних Azure](https://docs.microsoft.com/azure/storage/common/storage-import-export-data-from-blobs), до якому буде експортуватися вихідні дані.</span><span class="sxs-lookup"><span data-stu-id="65d2a-258">[Export them to the same Azure Blob storage location](https://docs.microsoft.com/azure/storage/common/storage-import-export-data-from-blobs) that you export the source data to.</span></span> <span data-ttu-id="65d2a-259">Можна запланувати, щоб прогнозована веб-служба регулярно запускалася й оновлювала показники.</span><span class="sxs-lookup"><span data-stu-id="65d2a-259">The predictive web service can be scheduled to run regularly and update the scores.</span></span>

<span data-ttu-id="65d2a-260">Дані, створені настроюваними моделями, можна використовувати для подальшого збагачення даних клієнтів.</span><span class="sxs-lookup"><span data-stu-id="65d2a-260">Data generated by the custom model can be used to further enrich your customer data.</span></span> <span data-ttu-id="65d2a-261">Додаткові відомості див. в розділі [Настроювані моделі машинного навчання](custom-models.md).</span><span class="sxs-lookup"><span data-stu-id="65d2a-261">For more information, see [Custom machine learning models](custom-models.md).</span></span>
