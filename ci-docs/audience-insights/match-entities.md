---
title: Зіставлення сутностей для уніфікації даних
description: Зіставлення сутностей для створення уніфікованих профілів клієнтів.
ms.date: 02/23/2021
ms.service: customer-insights
ms.subservice: audience-insights
ms.topic: tutorial
author: adkuppa
ms.author: adkuppa
ms.reviewer: mhart
manager: shellyha
ms.openlocfilehash: de53927f7ed1f58176a7ba83f89be7c39064947c
ms.sourcegitcommit: 5c9c54ffe045017c19f0042437ada2c101dcaa0f
ms.translationtype: HT
ms.contentlocale: uk-UA
ms.lasthandoff: 07/22/2021
ms.locfileid: "6650343"
---
# <a name="match-entities"></a>Пошук відповідностей у сутностях

У фазі пошуку відповідностей визначається спосіб комбінування наборів даних в уніфікований набір даних профілю клієнта. Після виконання [кроку зіставлення](map-entities.md) у процесі уніфікації даних ви готові до зіставлення сутностей. Фаза пошуку відповідностей вимагає наявності щонайменше двох зіставлених сутностей.

Сторінка зіставлення складається з трьох розділів: 
- Ключові показники, які підсумують кількість зіставлених записів
- Порядок пошуку відповідностей і правил для пошуку відповідностей між сутностями
- Правила вилучення повторів сутностей збігів

## <a name="specify-the-match-order"></a>Визначте порядок пошуку відповідностей.

Послідовно виберіть **Дані** > **Уніфікація** > **Зіставлення** та виберіть **Задати порядок**, щоб розпочати фазу зіставлення.

Кожне зіставлення об'єднує дві або більше сутності в єдину консолідовану сутність. У той же час зберігаються унікальні записи клієнтів. Наприклад, ми вибрали дві сутності: **eCommerce:eCommerceContacts** як основну сутність і **LoyaltyScheme:loyCustomers** як другу сутність. Порядок сутностей визначає порядок, в якому система намагатиметься зіставити записи.

:::image type="content" source="media/match-page.png" alt-text="Знімок екрана: сторінка зіставлення в області Unify процесу уніфікації даних.":::
  
Основна сутність *eCommerce:eCommerceContacts* зіставляється з сутністю *LoyaltyScheme:loyCustomers*. Набір даних, який є результатом першого кроку зіставлення, зіставлений з такою сутністю, якщо у вас більше двох сутностей.

> [!IMPORTANT]
> Сутність, яку було вибрано як основну, буде використовуватися як основа для єдиного уніфікованого набору даних профілів. До цієї сутності буде додано додаткові сутності, вибрані під час фази пошуку відповідностей. Це не означає, що об'єднана сутність міститиме *всі* дані, що належать до цієї сутності.
>
> Існує два міркування, які допоможуть вам вибрати ієрархію сутностей.
>
> - Виберіть сутність із найбільш повними та надійними даними профілю про клієнтів як основну сутність.
> - Виберіть сутність, яка має кілька спільних атрибутів з іншими сутностями (наприклад, ім'я, номер телефону або адреса електронної пошти) як основну сутність.

Після визначення порядку пошуку відповідностей визначені пари зіставлення відображаються в розділі **Відомості про зіставлення даних** у меню **Дані** > **Уніфікація** > **Пошук відповідностей**. Ключові показники будуть пустими, доки не завершиться процес пошуку відповідностей.

## <a name="define-rules-for-match-pairs"></a>Визначення правил зіставлення пар

Правила пошуку відповідностей визначають логіку, за якою буде зіставлятися певна пара сутностей.

Попередження **Потрібні правила** біля назви сутності передбачають, що для зіставлення пар не визначені правила пошуку відповідностей. 

:::image type="content" source="media/match-rule-add.png" alt-text="Знімок екрана: розділ «Відомості про відповідний запис» із елементом керування для додавання правил, виділених.":::

1. Щоб визначити правила пошуку відповідностей, натисніть **Додати правила** під сутністю у розділі **Відомості про зіставлені записи**.

1. У області **Створення правила** налаштуйте умови для правила.

   :::image type="content" source="media/match-rule-conditions.png" alt-text="Знімок екрана: відкрите правило зіставлення з доданими умовами.":::

   - **Сутність/Поле (перший рядок)**: виберіть відповідну сутність і атрибут, щоб визначити властивість запису, що може бути унікальною для клієнта. Наприклад, номер телефону або адреса електронної пошти. Уникайте зіставлення за атрибутами типу справи. Наприклад, ідентифікатор покупки зазвичай не знайде відповідності в інших типах записів.

   - **Сутність/Поле (другий рядок)**: виберіть атрибут, що стосується атрибуту сутності, визначеної у першому рядку.

   - **Нормалізувати**: виберіть з наведених параметрів нормалізації для вибраних атрибутів. 
     - Пробіл: видаляє всі пробіли. *Hello   World* стає *HelloWorld*.
     - Символи: видаляє всі символи та спеціальні знаки. *Head&Shoulder* стає *HeadShoulder*.
     - Текст у нижньому регістрі: перетворює усі символи на нижній регістр. *ALL CAPS and Title Case* стає *all caps and title case*.
     - Юнікод на ASCII: перетворює представлення юнікод на символи ASCII. */u00B2* стає *2*.
     - Числові значення: перетворює інші числові системи, наприклад римські цифри, на арабські цифри. *VIII* стає *8*.
     - Семантичні типи: стандартизує імена, заголовки, номери телефонів, адреси тощо. 

   - **Точність**: задаєте рівень точності, який застосовуватимуться для цієї умови. 
     - **Базові**: виберіть з-поміж значень *Низький*, *Середній*, *Високий* і *Точний*. Виберіть значення **Точне** для пошуку лише записів, які збігаються на 100 відсотків. Виберіть один із інших рівнів, щоб зіставити записи, які ідентичні не на 100 відсотків.
     - **Настроюваний**: установити відсоток, на який записи повинні збігатися. Система зіставлятиме лише записи, які перевищують цей поріг.

1. Вкажіть **Ім’я** для правила.

1. [Додайте інші умови](#add-conditions-to-a-rule) або **Готово**, щоб завершити правило.

1. За потреби [можна додати інші правила](#add-rules-to-a-match-pair).

1. Натисніть кнопку **Зберегти**, щоб застосувати зміни.

### <a name="add-conditions-to-a-rule"></a>Додавання умов для правила

Щоб зіставити сутності, лише якщо атрибути відповідають кільком умовам, додайте інші умови до правила зіставлення. Умови зв'язані з логічним оператором AND, отже, виконуються лише за виконання всіх умов.

1. Перейдіть до меню **Дані** > **Уніфікація** > **Знайти відповідності** і натисніть **Редагувати** у правилі, до якого потрібно додати умови.

1. В області **Редагувати правило** виберіть **Додати умову**.

1. Щоб зберегти правило, натисніть **Готово**.

### <a name="add-rules-to-a-match-pair"></a>Додавання правил до пар зіставлення

Правила зіставлення відповідають наборам умов. Щоб зіставити сутності за умовами на основі кількох атрибутів, додайте більше правил

1.  Перейдіть до меню **Дані** > **Уніфікація** > **Знайти відповідності** і натисніть **Додати правило** у сутності, до якої потрібно додати правила.

2. Виконайте кроки, описані в статті [Визначення правил для зіставлення пар](#define-rules-for-match-pairs).

> [!NOTE]
> Порядок правил має значення. Алгоритм пошуку відповідностей намагається зіставити за першим правилом і продовжує за другим правилом, лише якщо з першим правилом не було виявлено відповідності.

### <a name="change-the-entity-order-in-match-rules"></a>Змінення порядку сутностей в правилах зіставлення

Ви можете змінити порядок сутностей для правил зіставлення, щоб змінити порядок, в якому вони оброблятимуться. Правила, які конфліктуватимуть через зміну порядку, буде усунуто. Вам потрібно відтворити видалені правила, використовуючи оновлену конфігурацію.

1. Відкрийте **Дані** > **Уніфікація** > **Зіставлення** та виберіть **Редагувати**.

1. В області **Редагувати правило** виберіть елемент керування **Вгору/вниз** або перетягуйте сутності, щоб змінити їх порядок.

   :::image type="content" source="media/reorder-match-rules.png" alt-text="Варіанти зміни порядку обробки сутностей на фазі зіставлення.":::

1. Щоб зберегти правило, натисніть **Готово**.

## <a name="define-deduplication-on-a-match-entity"></a>Визначення вилучення дублікатів для сутності зіставлення

Крім [правил зіставлення між сутностями](#define-rules-for-match-pairs) можна також вказати правила вилучення повторів. *Видалення повторів* є іншим процесом під час зіставлення записів. Він знаходить повтори записів і зливає їх в один запис. Вихідні записи зв'язуються з злитим записом з альтернативними ідентифікаторами.

Записи, отримані після видалення повторів, використовуватиметься надалі у процесі перехресного зіставлення сутностей. Дедуплікація відбувається для окремих сутностей і може бути настроєна для кожної сутності, що використовується в парах зіставлення.

Зазначення правил вилучення дублікатів є необов'язковим. Якщо такі правила не настроєно, застосовуються системні правила. Вони об'єднують всі записи в єдиний запис, перш ніж передавати дані сутності до зіставлення між об'єктами для підвищення продуктивності.

### <a name="add-deduplication-rules"></a>Додавання правил вилучення дублікатів

1. Перейдіть до меню **Дані** > **Уніфікувати** > **Знайти відповідності**.

1. У розділі **Об'єднані повтори** виберіть **Установити сутності**. Якщо правила видалення повторів уже створені, натисніть **Редагувати**.

1. В області **Параметри злиття** виберіть сутності, до яких потрібно застосувати видалення повторів.

1. Укажіть спосіб злиття повторюваних записів і виберіть один із трьох параметрів.
   - **Максимально заповнений**: ідентифікує запис з найбільш заповненими полями атрибутів як переможний запис. Це стандартний параметр злиття.
   - **Найостанніший**: ідентифікує переможний запис на основі давності. Вимагає дати або числового поля для визначення давності.
   - **Найдавніший**: ідентифікує переможний запис на основі найбільшого значення давності. Вимагає дати або числового поля для визначення давності.
 
   > [!div class="mx-imgBorder"]
   > ![Правила вилучення дублікатів, крок 1.](media/match-selfconflation.png "Правила вилучення дублікатів, крок 1")
 
1. Після вибору сутностей і параметра злиття виберіть параметр **Додати правило**, щоб визначити правила видалення повторів на рівні сутності.
   - **Виберіть поле** перелічує всі доступні поля з цієї сутності. Виберіть поле, яке потрібно перевірити на наявність повторів. Виберіть поля, які є унікальними для кожного окремого клієнта. Наприклад, адреса електронної пошти або комбінація імені, міста й номера телефону.
   - Укажіть параметри нормалізації та точності.
   - Визначте додаткові умови, вибравши параметр **Додати умову**.
 
   > [!div class="mx-imgBorder"]
   > ![Правила вилучення дублікатів, крок 2.](media/match-selfconflation-rules.png "Правила вилучення дублікатів, крок 2")

  Можна створити кілька правил вилучення дублікатів для сутності. 

1. Запуск процесу зіставлення групує записи на основі умов, визначених у правилах видалення дублікатів. Після групування записів політика злиття застосовується для визначення переможного запису.

1. Потім цей запис-переможець передається до процесу перехресного зіставлення сутностей разом із записами, які не є переможцями (наприклад, альтернативними ідентифікаторами), для покращення якості зіставлення.

1. Будь-які визначені настроювані правила зіставлення перезаписують правила видалення повторів. Якщо правило вилучення дублікатів визначає відповідні записи, а правило настроюваного зіставлення не збігається з цими записами, ці два записи не буде зіставлено.

1. Після [запуску процесу зіставлення](#run-the-match-process) відобразиться статистика видалення повторів у плитках ключових показників.

### <a name="deduplication-output-as-an-entity"></a>Результати вилучення дублікатів як сутність

Процес видалення повторів створює нову сутність для кожної сутності з пар зіставлення, щоб визначити записи, в яких видалено повтори. Ці сутності можна знайти разом з **ConflationMatchPairs:CustomerInsights** в розділі **Система** на сторінці **Сутності** під іменем **Deduplication_DataSource_Entity**.

Сутність виводу вилучення дублікатів містить зазначені нижче відомості.
- Ідентифікатори / Ключі
  - Поле первинного ключа та поле альтернативних йому ідентифікаторів. Поле альтернативних ідентифікаторів складається з усіх альтернативних ідентифікаторів, визначених для запису.
  - Поле Deduplication_GroupId відображає групу або кластер, що визначається у сутності та групує усі подібні записи на основі вказаних полів вилучення дублікатів. Це використовується для цілей системної обробки. Якщо не вказано правил вилучення дублікатів вручну та застосовуються системні правила вилучення дублікатів, це поле може бути відсутнє у сутності виводу вилучення дублікатів.
  - Deduplication_WinnerId: у цьому полі міститься ідентифікатор переможця з визначених груп або кластерів. Якщо Deduplication_WinnerId співпадає зі значенням первинного ключа для запису, це означає, що цей запис є записом-переможцем.
- Поля використовуються для визначення правил вилучення дублікатів.
- Поля «Правило» та «Оцінка» вказують, які правила вилучення дублікатів було застосовано та яку оцінку було повернуто алгоритмом зіставлення.
   
## <a name="run-the-match-process"></a>Запуск процесу пошуку відповідностей

З налаштованими правилами зіставлення, включно з правилами для зіставлення сутностей та вилучення повторів, можна виконати процес пошуку відповідностей. 

Перейдіть до меню **Дані** > **Уніфікація** > **Знайти відповідності** і натисніть **Запустити**, щоб запустити процес. Алгоритм зіставлення займає певний час, і конфігурацію не можна буде змінити, доки він не завершиться. Щоб внести зміни, можна скасувати запуск. Виберіть стан завдання та натисніть кнопку **Скасувати завдання** в області **Відомості про перебіг**.

Результат успішного виконання, уніфікована сутність профілю клієнта відображається на сторінці **Сутності**. Ваша уніфікована сутність клієнта називається **Клієнти** в розділі **Профілі**. Під час першого успішного виконання зіставлення створюється уніфікована сутність *Клієнт*. Всі подальші зіставлення розширюють сутність.

> [!TIP]
> Після виконання процесу зіставлення виберіть стан процесу, щоб відкрити область **Відомості про завдання**. У ньому можна дізнатися про час обробки, дату останньої обробки, а також про всі помилки та попередження, пов'язані з завданням. Виберіть елемент **Докладно** для перегляду сутностей, які беруть участь у процесі зіставлення, правил, які було застосовано до них, а також чи були оновлення успішно опубліковані.  
> Існує [шість типів станів](system.md#status-types) для завдань/процесів. Крім того, більшість процесів [залежать від інших низхідних процесів](system.md#refresh-policies).  
> :::image type="content" source="media/process-detail-path.png" alt-text="Шлях до деталізації для отримання відомостей про процес за посиланням на стан завдання.":::

## <a name="review-and-validate-your-matches"></a>Перегляд і перевірка збігів

Перейдіть до меню **Дані** > **Уніфікація** > **Знайти відповідності**, щоб оцінити свої пари зіставлення й уточнити їх у разі потреби.

На плитках у верхній частині сторінки відображатимуться ключові показники, підсумовані за кількістю відповідних записів і повторів.

:::image type="content" source="media/match-KPIs.png" alt-text="Обрізаний знімок екрана з ключовими показниками на сторінці зіставлення з номерами та докладною інформацією.":::

- **Унікальні вихідні записи** відображають кількість окремих вихідних записів, які було оброблено під час виконання останнього пошуку відповідностей.
- **Зіставлені та незіставлені записи** показує, скільки унікальних записів залишається після оброблення правил пошуку відповідностей.
- **Лише зіставлені записи** відображає кількість зіставлень у всіх ваших парах зіставлення.

Результати кожної пари зіставлення і її правил можна знайти у таблиці **Відомості про зіставлені записи**. Порівняйте кількість записів, отриманих у парі зіставлення, і відсоток успішного зіставлених записів.

Перегляньте правила пари зіставлення, щоб побачити відсоток успішно зіставлених записів на рівні правила. Натисніть три крапки (...) і потім виберіть **Попередній перегляд відповідностей**, щоб переглянути всі ці записи на рівні правила. Ми рекомендуємо поглянути на деякі записи, щоб перевірити правильність їх зіставлення.

Щоб знайти оптимальне значення, спробуйте різні пороги точності в умовах.

  1. Натисніть три крапки (...) для правила, яке ви хочете змінити і натисніть **Редагувати**.

  2. Змініть значення точностей в умовах, які потрібно змінити.

  3. Виберіть **Підготовча версія**, щоб переглянути кількість зіставлених і незіставлених записів для вибраної умови.

## <a name="manage-match-rules"></a>Керування правилами пошуку відповідностей

Можна змінити настройки та налаштувати більшість параметрів зіставлення.

:::image type="content" source="media/match-rules-management.png" alt-text="Знімок екрана розкривного меню з параметрами правил зіставлення.":::

- **Змініть порядок правил**, якщо ви визначили кілька правил. Змінити правила зіставлення можна за допомогою вибору параметрів **Вгору** та **Вниз** або перетягуванням.

- **Змініть умови правила**, натиснувши **Редагувати** та вибравши інші поля.

- **Вимкніть правило**, щоб зберегти правило відповідності, але виключити його з процесу зіставлення.

- **Створіть повтор правила**, якщо ви визначили правило зіставлення і хотіли би створити аналогічне правило зі змінами, натисніть **Створити повтор**.

- **Видаліть правило**, натиснувши символ **Видалити**.

## <a name="specify-custom-match-conditions"></a>Визначте умови настроюваного зіставлення

Ви можете указати умови, яким певні записи мають завжди відповідати або ніколи не відповідати. Ці правила можна завантажити, щоб змінити стандартний процес зіставлення. Наприклад, якщо в записах є John Doe I і John Doe II, система може зіставити їх як одну особу. Настроювані правила зіставлення дають змогу вказати, що їхні профілі стосуються різних людей. 

1. Перейдіть до меню **Дані** > **Уніфікація** > **Знайти відповідності** і натисніть **Настроюване зіставлення** в розділі **Відомості про зіставлені записи**.

  :::image type="content" source="media/custom-match-create.png" alt-text="Знімок екрана: розділ правил зіставлення з виділеними настроюваними елементами керування настроюваним зіставленням.":::

1. Якщо ви не маєте набору настроюваних правил зіставлення, ви побачите область **Настрюване зіставлення** з додатковою інформацією.

1. Виберіть елемент **Заповнити шаблон**, щоб отримати файл шаблона, який може вказати, які записи з яких сутностей мають завжди збігатися або ніколи не збігатися. Вам доведеться окремо заповнити записи «завжди збігаються» і «ніколи не збігаються» у двох різних файлах.

1. Шаблон містить поля, які визначають сутність і значення первинного ключа сутності, які будуть використовуватися в настроюваному пошуку відповідностей. Наприклад, якщо вам потрібно, щоб первинний ключ *12345* з сутності *Збут* завжди зіставлявся з первинним ключем *34567* з сутності *Контакт*, заповніть шаблон:
    - Entity1: Збут
    - Entity1Key: 12345
    - Entity2: Контактна особа
    - Entity2Key: 34567

   Той самий файл шаблону може вказувати настроювані записи пошуку відповідностей з кількох сутностей.
   
   Якщо потрібно вказати настроюване зіставлення для вилучення дублікатів для сутності, укажіть ту саму сутність, що й Сутність1 і Сутність2, і встановіть різні значення первинного ключа.

1. Після додавання усіх заміщень, які необхідно застосувати, збережіть файл шаблону.

1. Перейдіть до розділу **Дані** > **Джерела даних** і прийміть файли шаблонів як нові сутності. Після додавання їх можна використовувати, щоб визначити конфігурацію пошуку відповідностей.

1. Після передавання файли та сутності стануть доступними. Виберіть параметр **Настроювана відповідність** ще раз. Відобразяться параметри для визначення сутностей, які необхідно включити. У розкривному меню виберіть необхідні сутності.

   :::image type="content" source="media/custom-match-overrides.png" alt-text="Знімок екрана: діалог вибору замін для настроюваного сценарію зіставлення.":::

1. Виберіть сутності, які потрібно використовувати для параметрів **Завжди відповідає** та **Ніколи не відповідає**, а потім натисніть кнопку **Готово**.

1. Натисніть **Зберегти** на сторінці **Пошук відповідностей**, щоб застосувати настроювану конфігурацію зіставлення.

1. Щоб розпочати зіставлення, натисніть **Запустити** на сторінці **Пошук відповідностей**. Інші вказані правила зіставлення буду перезаписані настроюваною конфігурацією зіставлення.

> [!TIP]
> Перейдіть до меню **Дані** > **Сутності** і перегляньте сутність **ConflationMatchPair**, щоб підтвердити застосування перезаписування.

## <a name="next-step"></a>Наступний крок

Після завершення процесу пошуку відповідностей для принаймні однієї пари відповідностей ви можете вирішити можливі суперечності в даних, ознайомившись з розділом [**Злиття**](merge-entities.md).


[!INCLUDE[footer-include](../includes/footer-banner.md)]
