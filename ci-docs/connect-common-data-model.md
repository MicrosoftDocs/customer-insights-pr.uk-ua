---
title: Підключіться до папки Common Data Model, використовуючи обліковий запис Azure Data Lake
description: Робота з даними Common Data Model за допомогою Azure Data Lake Storage.
ms.date: 07/27/2022
ms.topic: how-to
author: mukeshpo
ms.author: mukeshpo
ms.reviewer: v-wendysmith
manager: shellyha
searchScope:
- ci-data-sources
- ci-create-data-source
- ci-attach-cdm
- customerInsights
ms.openlocfilehash: b237c291bb4dd22ca22ab2cdd8b6293490aa83e1
ms.sourcegitcommit: 49394c7216db1ec7b754db6014b651177e82ae5b
ms.translationtype: MT
ms.contentlocale: uk-UA
ms.lasthandoff: 08/10/2022
ms.locfileid: "9245858"
---
# <a name="connect-to-data-in-azure-data-lake-storage"></a>Підключення до даних у Azure Data Lake Storage

Використовуйте дані за Dynamics 365 Customer Insights допомогою свого Azure Data Lake Storage облікового запису Gen2. Прийом даних може бути повним або інкрементним.

## <a name="prerequisites"></a>вимоги

- Прийом даних підтримує Azure Data Lake Storage *виключно облікові записи Gen2*. Ви не можете використовувати облікові записи Data Lake Storage Gen1 для прийому даних.

- В обліковому Azure Data Lake Storage записі [має бути ввімкнено ієрархічний простір імен](/azure/storage/blobs/data-lake-storage-namespace). Дані повинні зберігатися в ієрархічному форматі папок, який визначає кореневу папку та має вкладені папки для кожної сутності. Вкладені папки можуть містити повні папки з даними або інкрементними даними.

- Щоб пройти автентифікацію з допомогою принципалу служби Azure, переконайтеся, що вона налаштована у вашому клієнті. Для отримання додаткових відомостей дивіться [Підключення до облікового Azure Data Lake Storage запису Gen2 з директором](connect-service-principal.md) служби Azure.

- Дані Azure Data Lake Storage, з яких ви хочете підключитися та отримати дані, повинні знаходитися в тому ж регіоні Azure, що і навколишнє Dynamics 365 Customer Insights середовище. Підключення до спільної папки Common Data Model з озера даних в іншій області Azure не підтримується. Щоб дізнатися регіон Середовища Azure, перейдіть до **розділу Про** > **систему** > **адміністрування** в Customer Insights.

- Дані, що зберігаються в онлайн-службах, можуть зберігатися в іншому місці, ніж там, де дані обробляються або зберігаються в Dynamics 365 Customer Insights.Імпортуючи або підключаючись до даних, що зберігаються в онлайн-сервісах, ви погоджуєтеся з тим, що дані можуть передаватися і зберігатися за допомогою Dynamics 365 Customer Insights. [Дізнайтеся більше в Центрі](https://www.microsoft.com/trust-center) безпеки та конфіденційності Microsoft.

- Щоб отримати доступ до облікового запису сховища, директор служби Customer Insights має виконувати одну з наведених нижче ролей. Щоб отримати додаткові відомості, перегляньте статтю [Надання дозволів принципалу служби на доступ до облікового запису](connect-service-principal.md#grant-permissions-to-the-service-principal-to-access-the-storage-account) сховища.
  - Зчитувач даних BLOB-об'єктів сховища
  - Відповідальний для BLOB-об'єктів сховища
  - Постачальник даних BLOB-об’єктів сховища

- Дані у вашому сховищі Data Lake Storage повинні відповідати стандарту Common Data Model для зберігання ваших даних і мати загальний маніфест моделі даних, що представляє схему файлів даних (*.csv або *.parquet). Маніфест повинен містити деталі сутностей, таких як стовпці сутностей та типи даних, а також розташування файлу даних та тип файлу. Для отримання додаткових відомостей перегляньте [маніфест](/common-data-model/sdk/manifest) Загальної моделі даних. Якщо маніфесту немає, користувачі-адміністратори з доступом до даних BLOB-сервера сховища або постачальник даних BLOB-сховища можуть визначити схему під час прийому даних.

## <a name="connect-to-azure-data-lake-storage"></a>Підключитися до Azure Data Lake Storage

1. Відкрийте **Дані** > **Джерела даних**.

1. Виберіть **Додати джерело даних**.

1. Виберіть Сховище **озера** даних Azure.

   :::image type="content" source="media/data_sources_ADLS.png" alt-text="Діалогове вікно для введення відомостей про підключення для Azure Data Lake." lightbox="media/data_sources_ADLS.png":::

1. Введіть Ім’я **джерело** даних та необов’язковий **опис**. Назва однозначно ідентифікує джерело даних і згадується в низхідних процесах і не може бути змінена.

1. Виберіть один із наведених нижче параметрів підключення **сховища за допомогою**. Щоб отримати додаткові відомості, перегляньте статтю [Azure Data Lake Storage Підключення Customer Insights до облікового запису Gen2 з директором](connect-service-principal.md) служби Azure.

   - **Ресурс** Azure: введіть **ідентифікатор** ресурсу. За бажанням, якщо ви хочете отримати дані з облікового запису сховища за допомогою приватного посилання Azure, виберіть **Увімкнути приватне посилання**. Для отримання додаткової інформації дивіться [Приватні посилання](security-overview.md#set-up-an-azure-private-link).
   - **Передплата** Azure: виберіть передплату, **а** потім **– групу** ресурсів і **обліковий запис** Сховища. За бажанням, якщо ви хочете отримати дані з облікового запису сховища за допомогою приватного посилання Azure, виберіть **Увімкнути приватне посилання**. Для отримання додаткової інформації дивіться [Приватні посилання](security-overview.md#set-up-an-azure-private-link).
  
   > [!NOTE]
   > Щоб створити джерело даних, вам потрібна одна з наведених нижче ролей для контейнера або облікового запису сховища:
   >
   >  - Storage BLOB Data Reader достатньо, щоб прочитати з облікового запису сховища та проковтнути дані до Customer Insights. 
   >  - Постачальник або власник даних BLOB-сховища необхідний, якщо ви хочете відредагувати файли маніфесту безпосередньо в Customer Insights.  
  
1. Виберіть ім’я **контейнера**, що містить дані та схему (файл model.json або manifest.json), з якого потрібно імпортувати дані, і натисніть кнопку **Далі**.
   > [!NOTE]
   > Будь-який файл model.json або manifest.json, пов’язаний із іншим джерелом даних у середовищі, не відображатиметься в списку. Проте такий самий файл model.json або manifest.json може використовуватися для джерел даних у різних середовищах.

1. Щоб створити нову схему, перейдіть до [розділу Створення нового файлу](#create-a-new-schema-file) схеми.

1. Щоб скористатися наявною схемою, перейдіть до папки, що містить файл model.json або manifest.cdm.json. Ви можете шукати в каталозі, щоб знайти файл.

1. Виберіть файл json і натисніть кнопку **Далі**. Відобразиться список доступних сутностей.

   :::image type="content" source="media/review-entities.png" alt-text="Діалогове вікно зі списком сутностей, які потрібно вибрати":::

1. Виберіть сутності, які потрібно включити.

   :::image type="content" source="media/ADLS_required.png" alt-text="Діалогове вікно з відображенням обов’язкового для первинного ключа":::

   > [!TIP]
   > Щоб відредагувати сутність в інтерфейсі редагування JSON, виберіть сутність, а потім **– Редагувати файл схеми**. Внесіть зміни та натисніть кнопку **Зберегти**.

1. Для вибраних об’єктів, які потребують інкрементного прийому всередину, **"Обов’язковий"** відображається в розділі **Інкрементальне оновлення**. Для кожної з цих сутностей перегляньте статтю [Настроювання поступового оновлення для джерел](incremental-refresh-data-sources.md) даних Azure Data Lake.

1. Для вибраних сутностей, де первинний ключ не визначено, **обов’язковий** відображається в розділі **Первинний ключ**. Для кожного з цих суб’єктів:
   1. Виберіть обов’язковий **·**. Відобразиться панель " **Редагувати сутність** ".
   1. Виберіть первинний **ключ**. Первинний ключ - це атрибут, унікальний для сутності. Атрибут, який має стати дійсним первинним ключем, не повинен мати повторюваних значень, відсутніх значень або значень null. Атрибути типу даних String, integer і GUID підтримуються як первинні ключі.
   1. За бажанням можна змінити шаблон розбиття на розділи.
   1. Виберіть "Закрити"**·**, щоб зберегти та закрити панель.

1. Виберіть кількість атрибутів **для кожної** включеної сутності. Відобразиться сторінка " **Керування атрибутами** ".

   :::image type="content" source="media/dataprofiling-entities.png" alt-text="Діалогове вікно для вибору профілювання даних.":::

   1. Створюйте нові атрибути, редагуйте або видаляйте існуючі атрибути. Ви можете змінити ім’я, формат даних або додати семантичний тип.
   1. Щоб увімкнути аналітику та інші можливості, виберіть профілювання **даних** для всієї сутності або для певних атрибутів. За замовчуванням для профілювання даних не ввімкнуто жодної сутності.
   1. Виберіть **Готово**.

1. Виберіть **Зберегти**. Відкриється сторінка Джерела **даних** із новим джерело даних у **стані Оновлення**.

   [!INCLUDE [progress-details-include](includes/progress-details-pane.md)]

Завантаження даних може тривати значний час. Після успішного оновлення дані, що надійшли, можна переглянути зі сторінки « [**Сутності**](entities.md) ».

### <a name="create-a-new-schema-file"></a>Створення нового файлу схеми

1. Виберіть " **Створити файл схеми"**.

1. Введіть ім’я файлу та натисніть кнопку **Зберегти**.

1. Виберіть Нова **сутність**. Відобразиться панель " **Нова сутність** ".

1. Введіть ім’я сутності та виберіть **розташування** файлів даних.
   - **Кілька файлів** .csv або паркету: перейдіть до кореневої теки, виберіть тип візерунка та введіть вираз.
   - **Файли з .csv або паркету**: перейдіть до файлу .csv або паркету та виберіть його.

   :::image type="content" source="media/ADLS_new_entity_location.png" alt-text="Діалогове вікно для створення нової сутності з виділеним розташуванням файлів даних.":::

1. Виберіть **Зберегти**.

   :::image type="content" source="media/ADLS_new_entity_define_attributes.png" alt-text="Діалогове вікно для визначення або автоматичного створення атрибутів.":::

1. Виберіть визначення **атрибутів** для ручного додавання атрибутів або виберіть **автоматичне їх** створення. Щоб визначити атрибути, введіть ім’я, виберіть формат даних та необов’язковий семантичний тип. Для автоматично згенерованих атрибутів:

   1. Після автоматичного створення атрибутів виберіть "Атрибути **рецензування"**. Відобразиться сторінка " **Керування атрибутами** ".

   1. Переконайтеся, що формат даних правильний для кожного атрибута.

   1. Щоб увімкнути аналітику та інші можливості, виберіть профілювання **даних** для всієї сутності або для певних атрибутів. За замовчуванням для профілювання даних не ввімкнуто жодної сутності.

      :::image type="content" source="media/dataprofiling-entities.png" alt-text="Діалогове вікно для вибору профілювання даних.":::

   1. Виберіть **Готово**. Відобразиться **сторінка "Вибір сутностей** ".

1. Продовжуйте додавати сутності та атрибути, якщо це можливо.

1. Після додавання всіх сутностей виберіть "Включити **"**, щоб включити сутності до джерело даних прийому.

   :::image type="content" source="media/ADLS_required.png" alt-text="Діалогове вікно з відображенням обов’язкового для первинного ключа":::

1. Для вибраних об’єктів, які потребують інкрементного прийому всередину, **"Обов’язковий"** відображається в розділі **Інкрементальне оновлення**. Для кожної з цих сутностей перегляньте статтю [Настроювання поступового оновлення для джерел](incremental-refresh-data-sources.md) даних Azure Data Lake.

1. Для вибраних сутностей, де первинний ключ не визначено, **обов’язковий** відображається в розділі **Первинний ключ**. Для кожного з цих суб’єктів:
   1. Виберіть обов’язковий **·**. Відобразиться панель " **Редагувати сутність** ".
   1. Виберіть первинний **ключ**. Первинний ключ - це атрибут, унікальний для сутності. Атрибут, який має стати дійсним первинним ключем, не повинен мати повторюваних значень, відсутніх значень або значень null. Атрибути типу даних String, integer і GUID підтримуються як первинні ключі.
   1. За бажанням можна змінити шаблон розбиття на розділи.
   1. Виберіть "Закрити"**·**, щоб зберегти та закрити панель.

1. Виберіть **Зберегти**. Відкриється сторінка Джерела **даних** із новим джерело даних у **стані Оновлення**.

   [!INCLUDE [progress-details-include](includes/progress-details-pane.md)]

Завантаження даних може тривати значний час. Після успішного оновлення дані, що надійшли, можна переглянути зі сторінки « [**Сутності**](entities.md) ».

## <a name="edit-an-azure-data-lake-storage-data-source"></a>Azure Data Lake Storage Редагування джерело даних

Ви можете оновити обліковий *запис Підключитися до сховища за допомогою* параметра. Щоб отримати додаткові відомості, перегляньте статтю [Azure Data Lake Storage Підключення Customer Insights до облікового запису Gen2 з директором](connect-service-principal.md) служби Azure. Щоб підключитися до іншого контейнера зі свого облікового запису сховища або змінити ім’я облікового запису, [створіть нове підключення до джерела даних](#connect-to-azure-data-lake-storage).

1. Відкрийте **Дані** > **Джерела даних**.

1. Поруч із джерело даних потрібно оновити, натисніть кнопку **Редагувати**.

   :::image type="content" source="media/data_sources_edit_ADLS.png" alt-text="Діалогове вікно для редагування джерело даних Azure Data Lake.":::

1. Змініть будь-яку з наведених нижче відомостей.

   - **Опис**
   - **Підключіть сховище за допомогою** інформації про підключення та підключення. Під час оновлення з'єднання інформацію про **Контейнер** змінити не можна.
      > [!NOTE]
      > На рахунок зберігання або контейнера повинна бути призначена одна з наступних ролей:
        > - Зчитувач даних BLOB-об'єктів сховища
        > - Відповідальний для BLOB-об'єктів сховища
        > - Постачальник даних BLOB-об’єктів сховища

   - **Увімкніть приватне посилання**, якщо ви хочете отримати дані з облікового запису сховища за допомогою приватного посилання Azure. Для отримання додаткової інформації дивіться [Приватні посилання](security-overview.md#set-up-an-azure-private-link).

1. Виберіть **Далі**.
1. Змініть будь-який із наведених нижче елементів.
   - Перейдіть до іншого файлу model.json або manifest.json з іншим набором сутностей з контейнера.
   - Щоб додати додаткові сутності для прийому, виберіть " **Нова сутність**".
   - Щоб видалити будь-які вже вибрані сутності, якщо немає залежностей, виберіть сутність і **Видалити**.
      > [!IMPORTANT]
      > Якщо існують залежності від наявного файлу model.json або manifest.json і набору сутностей, ви побачите повідомлення про помилку та не зможете вибрати інший файл model.json або manifest.json. Усуньте ці залежності перед тим, як змінювати файл model.json або manifest.json, або ж створіть нове джерело даних з файлом model.json або manifest.json, який потрібно використовувати, щоб уникнути усунення залежностей.
   - Щоб змінити розташування файлу даних або первинного ключа, натисніть кнопку **Редагувати**.
   - Щоб змінити інкрементні дані про прийом всередину, перегляньте статтю [Настроювання інкрементного оновлення для джерел](incremental-refresh-data-sources.md) даних Azure Data Lake.
   - Змініть ім’я сутності лише так, щоб воно відповідало імені сутності у файлі .json.

     > [!NOTE]
     > Завжди зберігайте ім’я сутності в Customer Insights так само, як і ім’я сутності всередині файлу model.json або manifest.json після прийому. Customer Insights перевіряє всі імена сутностей за допомогою model.json або manifest.json під час кожного оновлення системи. Якщо ім’я організації змінено або всередині Customer Insights, або зовні, виникає помилка, оскільки Customer Insights не може знайти нове ім’я сутності у файлі .json. Якщо випадково змінено ім’я суб’єкта господарювання, що проковтнув, відредагуйте ім’я сутності в Customer Insights, щоб воно відповідало імені у файлі JSON.

1. Виберіть " **Атрибути** ", щоб додати або змінити атрибути або ввімкнути профілювання даних. Потім натисніть **Готово**.

1. Натисніть кнопку **Зберегти**, щоб застосувати зміни та повернутися на сторінку **Джерела** даних.

   [!INCLUDE [progress-details-include](includes/progress-details-pane.md)]

[!INCLUDE [footer-include](includes/footer-banner.md)]
