---
title: Підключення даних Common Data Model до облікового запису Azure Data Lake
description: Робота з даними Common Data Model за допомогою Azure Data Lake Storage.
ms.date: 05/30/2022
ms.topic: how-to
author: mukeshpo
ms.author: mukeshpo
ms.reviewer: v-wendysmith
manager: shellyha
searchScope:
- ci-data-sources
- ci-create-data-source
- ci-attach-cdm
- customerInsights
ms.openlocfilehash: 2ab7ec77252be33f1203959c2a596ddec20425f2
ms.sourcegitcommit: 5e26cbb6d2258074471505af2da515818327cf2c
ms.translationtype: MT
ms.contentlocale: uk-UA
ms.lasthandoff: 06/14/2022
ms.locfileid: "9011598"
---
# <a name="connect-to-data-in-azure-data-lake-storage"></a>Підключення до даних у Azure Data Lake Storage

Проковтнути дані у використанні Dynamics 365 Customer Insights вашого Azure Data Lake Storage облікового запису Gen2. Прийом даних може бути повним або поступовим.

## <a name="prerequisites"></a>вимоги

- Прийом даних підтримує Azure Data Lake Storage *виключно облікові записи Gen2*. Ви не можете використовувати облікові записи Data Lake Storage Gen1 для отримання даних.

- Обліковий Azure Data Lake Storage запис А комп'ютера має бути [увімкнено ієрархічний простір імен](/azure/storage/blobs/data-lake-storage-namespace). Дані мають зберігатися в ієрархічному форматі папки, який визначає кореневу папку та містить вкладені папки для кожної сутності. Вкладені папки можуть мати повні дані або інкрементні папки даних.

- Щоб пройти автентифікацію з допомогою принципалу служби Azure, переконайтеся, що вона налаштована у вашому клієнті. Для отримання додаткових відомостей див [.Azure Data Lake Storage](connect-service-principal.md)

- Потрібно Azure Data Lake Storage підключитися та проковтнути дані з має бути в тому ж регіоні Azure, що й навколишнє Dynamics 365 Customer Insights середовище. Підключення до спільної папки Common Data Model з озера даних в іншій області Azure не підтримується. Щоб дізнатися azure області навколишнього середовища, перейдіть до **системи** > **адміністрування** > **про** в статистику клієнтів.

- Дані, що зберігаються в онлайнових службах, можуть зберігатися в іншому місці, ніж там, де дані обробляються або зберігаються в Dynamics 365 Customer Insights.Імпортуючи або підключаючись до даних, що зберігаються в онлайнових службах, ви погоджуєтеся з тим, що дані можуть передаватися та зберігатися за допомогою Dynamics 365 Customer Insights програми . [Докладніше про це можна дізнатися в Центрі безпеки та конфіденційності Microsoft](https://www.microsoft.com/trust-center).

- Для доступу до облікового запису сховища головний клієнт має виконувати одну з таких ролей. Для отримання додаткових відомостей [див](connect-service-principal.md#grant-permissions-to-the-service-principal-to-access-the-storage-account).
  - Зчитувач даних BLOB-об'єктів сховища
  - Відповідальний для BLOB-об'єктів сховища
  - Постачальник даних BLOB-об’єктів сховища

- Дані у сховищі data lake повинні відповідати стандарту Common Data Model для зберігання ваших даних і мати загальний маніфест моделі даних для представлення схеми файлів даних (*.csv або *.parquet). Маніфест повинен містити відомості про сутності, такі як стовпці сутностей і типи даних, а також розташування файлу даних і тип файлу файлу даних. Для отримання додаткових відомостей [див](/common-data-model/sdk/manifest). Якщо маніфест відсутній, користувачі адміністратора з власником даних BLOB-об'єктів сховища або доступом до постачальника даних blob-об'єкта сховища можуть визначити схему під час прийому даних.

## <a name="connect-to-azure-data-lake-storage"></a>Підключення до Azure Data Lake Storage

1. Відкрийте **Дані** > **Джерела даних**.

1. Виберіть **Додати джерело даних**.

1. Виберіть **Azure data lake storage**.

   :::image type="content" source="media/data_sources_ADLS.png" alt-text="Діалогове вікно для введення відомостей про підключення для озера даних Azure." lightbox="media/data_sources_ADLS.png":::

1. Введіть ім'я **джерело** даних та необов'язковий **опис**. Ім'я однозначно ідентифікує джерело даних і посилається на процеси вниз за течією і не може бути змінене.

1. Виберіть один із наведених нижче параметрів підключення сховища за **допомогою**. Для отримання додаткових [Azure Data Lake Storage відомостей див](connect-service-principal.md).

   - **Azure resource**: введіть **ідентифікатор** ресурсу. За бажанням, якщо ви хочете проковтнути дані з облікового запису сховища через Azure Private Link, виберіть **увімкнути приватне посилання**. Для отримання додаткових [відомостей див](security-overview.md#private-links-tab).
   - **Azure підписка**: виберіть підписку **,** а потім **група** ресурсів і **обліковий запис А комп'ютера** сховища. За бажанням, якщо ви хочете проковтнути дані з облікового запису сховища через Azure Private Link, виберіть **увімкнути приватне посилання**. Для отримання додаткових [відомостей див](security-overview.md#private-links-tab).
  
   > [!NOTE]
   > Для створення джерело даних потрібна одна з таких ролей контейнера або облікового запису сховища:
   >
   >  - Storage Blob Data Reader достатньо, щоб прочитати з облікового запису сховища та проковтнути дані до статистики клієнта. 
   >  - Якщо ви хочете редагувати файли маніфестів безпосередньо в службі "Статистика клієнтів", потрібно зберігати дані сховища або власника.  
  
1. Виберіть ім'я **контейнера**, який містить дані та схему (файл model.json або manifest.json), з якого потрібно імпортувати дані, і натисніть кнопку **Далі**.
   > [!NOTE]
   > Будь-який файл model.json або manifest.json, пов’язаний із іншим джерелом даних у середовищі, не відображатиметься в списку. Проте такий самий файл model.json або manifest.json може використовуватися для джерел даних у різних середовищах.

1. Щоб створити нову схему, перейдіть до [створення нового файлу](#create-a-new-schema-file) схеми.

1. Щоб скористатися наявною схемою, перейдіть до папки, що містить файл model.json або manifest.cdm.json. Ви можете шукати в каталозі, щоб знайти файл.

1. Виберіть файл json і натисніть кнопку **Далі**. Відобразиться список доступних сутностей.

   :::image type="content" source="media/review-entities.png" alt-text="Діалогове вікно списку сутностей для вибору":::

1. Виберіть сутності, які потрібно включити.

   :::image type="content" source="media/ADLS_required.png" alt-text="Діалогове вікно з обов'язковим для первинного ключа":::

   > [!TIP]
   > Щоб змінити сутності в інтерфейсі редагування JSON, виберіть пункт **Показати більше** > **файл** схеми Редагування. Внесіть зміни та натисніть кнопку **Зберегти**.

1. Для вибраних сутностей, які потребують інкрементного прийому, **обов'язкові** дисплеї в розділі **Інкрементне оновлення**. Для кожної з цих сутностей [див](incremental-refresh-data-sources.md).

1. Для вибраних сутностей, де первинний ключ не визначено, **обов'язковий** відображається в розділі **Первинний ключ**. Для кожної з цих сутностей:
   1. Виберіть Обов'язковий **·**. Відображається **панель "Редагувати сутності** ".
   1. Виберіть первинний **ключ**. Первинний ключ є атрибутом, унікальним для сутності. Атрибут, який має стати дійсним первинним ключем, не повинен мати повторюваних значень, відсутніх значень або значень null. Атрибути типу даних String, integer та GUID підтримуються як первинні ключі.
   1. За бажанням змініть шаблон розділу.
   1. Натисніть кнопку **Закрити**, щоб зберегти та закрити панель.

1. Виберіть кількість атрибутів **для кожної включеної** сутності. Відобразиться сторінка Керування **атрибутами**.

   :::image type="content" source="media/dataprofiling-entities.png" alt-text="Діалогове вікно для вибору профілювання даних.":::

   1. Створення нових атрибутів, редагування або видалення наявних атрибутів. Можна змінити ім'я, формат даних або додати семантичний тип.
   1. Щоб увімкнути аналітику та інші можливості, виберіть пункт **Профілювання** даних для всієї сутності або для певних атрибутів. За замовчуванням для профілювання даних не ввімкнуто жодної сутності.
   1. Виберіть **Готово**.

1. Виберіть **Зберегти**. Відкриється **сторінка Джерела даних** із новим джерело даних у **стані оновлення**.

### <a name="create-a-new-schema-file"></a>Створення нового файлу схеми

1. Виберіть новий **файл** схеми.

1. Введіть ім'я файлу та натисніть кнопку **Зберегти**.

1. Виберіть елемент **Створити сутність**. Відображається панель " **Нова сутність** ".

1. Введіть ім'я сутності та виберіть **розташування** файлів даних.
   - **Кілька .csv або паркетних файлів**: Перейдіть до кореневої папки, виберіть тип візерунка та введіть вираз.
   - **Одиночні .csv або паркетні файли**: перейдіть до файлу .csv або паркету та виберіть його.

   :::image type="content" source="media/ADLS_new_entity_location.png" alt-text="Діалогове вікно для створення нової сутності з виділеним розташуванням файлів даних.":::

1. Виберіть **Зберегти**.

   :::image type="content" source="media/ADLS_new_entity_define_attributes.png" alt-text="Діалогове вікно для визначення або автоматичного створення атрибутів.":::

1. Виберіть визначити **атрибути**, які потрібно вручну додати атрибути, або вибрати **автоматичне їх** створення. Щоб визначити атрибути, введіть ім'я, виберіть формат даних і необов'язковий семантичний тип. Для автоматично створених атрибутів:

   1. Після автоматичного створення атрибутів виберіть Переглянути **атрибути**. Відобразиться сторінка Керування **атрибутами**.

   1. Переконайтеся, що формат даних правильний для кожного атрибута.

   1. Щоб увімкнути аналітику та інші можливості, виберіть пункт **Профілювання** даних для всієї сутності або для певних атрибутів. За замовчуванням для профілювання даних не ввімкнуто жодної сутності.

      :::image type="content" source="media/dataprofiling-entities.png" alt-text="Діалогове вікно для вибору профілювання даних.":::

   1. Виберіть **Готово**. Відобразиться **сторінка Вибір сутностей**.

1. Продовжуйте додавати сутності та атрибути, якщо це можливо.

1. Після додавання всіх сутностей виберіть елемент **Включити**, щоб включити сутності до джерело даних проковтування.

   :::image type="content" source="media/ADLS_required.png" alt-text="Діалогове вікно з обов'язковим для первинного ключа":::

1. Для вибраних сутностей, які потребують інкрементного прийому, **обов'язкові** дисплеї в розділі **Інкрементне оновлення**. Для кожної з цих сутностей [див](incremental-refresh-data-sources.md).

1. Для вибраних сутностей, де первинний ключ не визначено, **обов'язковий** відображається в розділі **Первинний ключ**. Для кожної з цих сутностей:
   1. Виберіть Обов'язковий **·**. Відображається **панель "Редагувати сутності** ".
   1. Виберіть первинний **ключ**. Первинний ключ є атрибутом, унікальним для сутності. Атрибут, який має стати дійсним первинним ключем, не повинен мати повторюваних значень, відсутніх значень або значень null. Атрибути типу даних String, integer та GUID підтримуються як первинні ключі.
   1. За бажанням змініть шаблон розділу.
   1. Натисніть кнопку **Закрити**, щоб зберегти та закрити панель.

1. Виберіть **Зберегти**. Відкриється **сторінка Джерела даних** із новим джерело даних у **стані оновлення**.


## <a name="edit-an-azure-data-lake-storage-data-source"></a>Azure Data Lake Storage Редагування джерело даних

Можна оновити обліковий *запис підключення до сховища за допомогою* параметра. Для отримання додаткових [Azure Data Lake Storage відомостей див](connect-service-principal.md). Щоб підключитися до іншого контейнера зі свого облікового запису сховища або змінити ім’я облікового запису, [створіть нове підключення до джерела даних](#connect-to-azure-data-lake-storage).

1. Відкрийте **Дані** > **Джерела даних**.

1. Поруч із джерело даних, який потрібно оновити, натисніть **редагувати**.

   :::image type="content" source="media/data_sources_edit_ADLS.png" alt-text="Діалогове вікно для редагування джерело даних Azure Data Lake.":::

1. Змініть будь-яку з таких відомостей:

   - **Опис**
   - **Підключіть сховище за допомогою** відомостей про підключення та підключення. Під час оновлення з'єднання інформацію про **Контейнер** змінити не можна.
      > [!NOTE]
      > Обліковому запису зберігання або контейнеру потрібно призначити одну з таких ролей:
        > - Зчитувач даних BLOB-об'єктів сховища
        > - Відповідальний для BLOB-об'єктів сховища
        > - Постачальник даних BLOB-об’єктів сховища

   - **Увімкніть приватне посилання,** якщо ви хочете проковтнути дані з облікового запису сховища через Azure Private Link. Для отримання додаткових [відомостей див](security-overview.md#private-links-tab).

1. Виберіть **Далі**.
1. Змініть будь-яку з таких дій:
   - Перейдіть до іншого файлу model.json або manifest.json з іншим набором сутностей з контейнера.
   - Щоб додати додаткові сутності до прийому, виберіть елемент **Створити сутність**.
   - Щоб видалити всі вже вибрані сутності, якщо немає залежностей, виберіть сутність і **Видалити**.
      > [!IMPORTANT]
      > Якщо існують залежності від наявного файлу model.json або manifest.json і набору сутностей, ви побачите повідомлення про помилку та не зможете вибрати інший файл model.json або manifest.json. Усуньте ці залежності перед тим, як змінювати файл model.json або manifest.json, або ж створіть нове джерело даних з файлом model.json або manifest.json, який потрібно використовувати, щоб уникнути усунення залежностей.
   - Щоб змінити розташування файлу даних або первинний ключ, натисніть кнопку **Редагувати**.
   - Щоб змінити інкрементні дані проковтування, див [.](incremental-refresh-data-sources.md)

1. Виберіть " **Атрибути** ", щоб додати або змінити атрибути, або ввімкнути профілювання даних. Потім натисніть **Готово**.

1. Натисніть кнопку **Зберегти**, щоб застосувати зміни та повернутися до **сторінки Джерела** даних.
