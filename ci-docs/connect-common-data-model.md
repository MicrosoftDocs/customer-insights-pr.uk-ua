---
title: Підключіться до папки Common Data Model, використовуючи обліковий запис Azure Data Lake
description: Робота з даними Common Data Model за допомогою Azure Data Lake Storage.
ms.date: 05/30/2022
ms.topic: how-to
author: mukeshpo
ms.author: mukeshpo
ms.reviewer: v-wendysmith
manager: shellyha
searchScope:
- ci-data-sources
- ci-create-data-source
- ci-attach-cdm
- customerInsights
ms.openlocfilehash: b1cdcb46df17d722ad49d361ae4c7ab34c83eeb1
ms.sourcegitcommit: dca46afb9e23ba87a0ff59a1776c1d139e209a32
ms.translationtype: MT
ms.contentlocale: uk-UA
ms.lasthandoff: 06/29/2022
ms.locfileid: "9082271"
---
# <a name="connect-to-data-in-azure-data-lake-storage"></a>Підключення до даних у Azure Data Lake Storage

Проковтуйте дані для Dynamics 365 Customer Insights використання свого Azure Data Lake Storage облікового запису Gen2. Прийом даних може бути повним або інкрементним.

## <a name="prerequisites"></a>вимоги

- Прийом даних підтримує Azure Data Lake Storage *виключно облікові записи Gen2*. Ви не можете використовувати облікові записи Data Lake Storage Gen1 для прийому даних.

- Обліковий Azure Data Lake Storage запис повинен мати [включений ієрархічний простір імен](/azure/storage/blobs/data-lake-storage-namespace). Дані повинні зберігатися у форматі ієрархічної папки, який визначає кореневу папку та має вкладені папки для кожної сутності. Вкладені папки можуть мати повні дані або додаткові папки даних.

- Щоб пройти автентифікацію з допомогою принципалу служби Azure, переконайтеся, що вона налаштована у вашому клієнті. Для отримання додаткових відомостей перегляньте статтю [Підключення до облікового Azure Data Lake Storage запису Gen2 за допомогою принципу](connect-service-principal.md) служби Azure.

- Дані Azure Data Lake Storage, з яких ви хочете підключитися та проковтнути, повинні знаходитися в тій же області Azure, що і навколишнє Dynamics 365 Customer Insights середовище. Підключення до спільної папки Common Data Model з озера даних в іншій області Azure не підтримується. Щоб дізнатися про регіон середовища Azure, перейдіть до **розділу Адміністрування** > **системи** > **в** Customer Insights.

- Дані, що зберігаються в онлайн-сервісах, можуть зберігатися в іншому місці, ніж там, де дані обробляються або зберігаються в Dynamics 365 Customer Insights.Імпортуючи або підключаючись до даних, що зберігаються в онлайн-сервісах, ви погоджуєтеся з тим, що дані можуть передаватися і зберігатися разом з Dynamics 365 Customer Insights. [Дізнайтеся більше в Центрі безпеки та конфіденційності Microsoft](https://www.microsoft.com/trust-center).

- Директор служби Customer Insights повинен виконувати одну з наведених нижче ролей, щоб отримати доступ до облікового запису сховища. Щоб отримати додаткові відомості, перегляньте статтю [Надання дозволів принципалу служби на доступ до облікового запису](connect-service-principal.md#grant-permissions-to-the-service-principal-to-access-the-storage-account) сховища.
  - Зчитувач даних BLOB-об'єктів сховища
  - Відповідальний для BLOB-об'єктів сховища
  - Постачальник даних BLOB-об’єктів сховища

- Дані у вашому сховищі Data Lake повинні відповідати стандарту Загальної моделі даних для зберігання ваших даних і мати загальну модель даних, яка проявляється, щоб представляти схему файлів даних (*.csv або *.parquet). Маніфест повинен містити відомості про такі сутності, як стовпці сутностей і типи даних, а також розташування файлу даних і тип файлу. Для отримання додаткової інформації дивіться [Маніфест "Загальна модель даних"](/common-data-model/sdk/manifest). Якщо маніфесту немає, користувачі-адміністратори, які мають доступ до data BLOB Storage Blob або Постачальника даних сховища BLOB, можуть визначити схему під час прийому даних.

## <a name="connect-to-azure-data-lake-storage"></a>Підключення до Azure Data Lake Storage

1. Відкрийте **Дані** > **Джерела даних**.

1. Виберіть **Додати джерело даних**.

1. Виберіть сховище **Azure data lake**.

   :::image type="content" source="media/data_sources_ADLS.png" alt-text="Діалогове вікно для введення даних про з'єднання для Azure Data Lake." lightbox="media/data_sources_ADLS.png":::

1. Введіть ім'я **для** джерело даних та необов'язковий **опис**. Назва однозначно ідентифікує джерело даних і посилається в процесах нижче за течією і не може бути змінена.

1. Виберіть один із наведених нижче параметрів для підключення сховища за **допомогою**. Для отримання додаткової інформації перегляньте статтю [Підключення Customer Insights до облікового Azure Data Lake Storage запису Gen2 за допомогою принципу](connect-service-principal.md) обслуговування Azure.

   - **Ресурс** Azure: введіть **ідентифікатор** ресурсу. За бажанням, якщо ви хочете отримати дані з облікового запису сховища через приватне посилання Azure, виберіть **увімкнути приватне посилання**. Для отримання додаткової інформації дивіться [Приватні посилання](security-overview.md#private-links-tab).
   - **Передплата** Azure: виберіть передплату, **а** потім **групу** ресурсів і **обліковий запис** сховища. За бажанням, якщо ви хочете отримати дані з облікового запису сховища через приватне посилання Azure, виберіть **увімкнути приватне посилання**. Для отримання додаткової інформації дивіться [Приватні посилання](security-overview.md#private-links-tab).
  
   > [!NOTE]
   > Щоб створити джерело даних, потрібна одна з наведених нижче ролей для контейнера або облікового запису сховища:
   >
   >  - Зчитувач даних BLOB зберігання достатньо, щоб прочитати з облікового запису сховища та передати дані до Customer Insights. 
   >  - Постачальник або власник даних BLOB сховища потрібен, якщо ви хочете відредагувати файли маніфесту безпосередньо в Customer Insights.  
  
1. Виберіть ім'я **контейнера**, який містить дані та схему (model.json або файл manifest.json), з якого потрібно імпортувати дані, і натисніть кнопку **Далі**.
   > [!NOTE]
   > Будь-який файл model.json або manifest.json, пов’язаний із іншим джерелом даних у середовищі, не відображатиметься в списку. Проте такий самий файл model.json або manifest.json може використовуватися для джерел даних у різних середовищах.

1. Щоб створити нову схему, перейдіть до [розділу Створення нового файлу](#create-a-new-schema-file) схеми.

1. Щоб скористатися наявною схемою, перейдіть до теки, що містить файл model.json або manifest.cdm.json. Ви можете шукати в каталозі, щоб знайти файл.

1. Виберіть файл json і натисніть кнопку **Далі**. Відобразиться список доступних сутностей.

   :::image type="content" source="media/review-entities.png" alt-text="Діалогове вікно списку сутностей, які потрібно вибрати":::

1. Виберіть сутності, які потрібно включити.

   :::image type="content" source="media/ADLS_required.png" alt-text="Діалогове вікно &quot;Обов'язкове для первинного ключа&quot;":::

   > [!TIP]
   > Щоб відредагувати сутності в інтерфейсі редагування JSON, виберіть " **Показати більше** > **редагувати файл** схеми". Внесіть зміни та натисніть кнопку **Зберегти**.

1. Для вибраних сутностей, які потребують інкрементного прийому всередину, **обов'язкове** відображення в розділі **Поступове оновлення**. Для кожної з цих сутностей перегляньте статтю [Настроювання поступового оновлення для джерел даних Azure Data Lake](incremental-refresh-data-sources.md).

1. Для вибраних сутностей, де первинний ключ не визначено, **обов'язкове** відображення відображається в розділі **Первинний ключ**. Для кожного з цих суб'єктів:
   1. Виберіть обов'язковий **.** Відобразиться **панель "Редагувати сутність** ".
   1. Виберіть первинний **ключ**. Первинний ключ є атрибутом, унікальним для сутності. Атрибут, який має стати дійсним первинним ключем, не повинен мати повторюваних значень, відсутніх значень або значень null. Атрибути типу даних String, Integer і GUID підтримуються як первинні ключі.
   1. За потреби змініть шаблон розділу.
   1. Виберіть " **Закрити"**, щоб зберегти та закрити панель.

1. Виберіть кількість атрибутів **для кожної** включеної сутності. Відобразиться **сторінка "Керування атрибутами** ".

   :::image type="content" source="media/dataprofiling-entities.png" alt-text="Діалогове вікно для вибору профілювання даних.":::

   1. Створюйте нові атрибути, редагуйте або видаляйте існуючі атрибути. Можна змінити ім'я, формат даних або додати семантичний тип.
   1. Щоб увімкнути аналітику та інші можливості, виберіть елемент **Профілювання** даних для всієї сутності або для певних атрибутів. За замовчуванням для профілювання даних не ввімкнуто жодної сутності.
   1. Виберіть **Готово**.

1. Виберіть **Зберегти**. Відкриється **сторінка Джерела** даних із новим джерело даних у **стані оновлення**.

### <a name="create-a-new-schema-file"></a>Створення нового файлу схеми

1. Виберіть елемент **Новий файл** схеми.

1. Введіть ім'я файлу та натисніть кнопку **Зберегти**.

1. Виберіть елемент **Нова сутність**. Відобразиться **панель "Нова сутність** ".

1. Введіть ім'я сутності та виберіть **розташування** файлів даних.
   - **Кілька файлів** .csv або .parquet: перейдіть до кореневої теки, виберіть тип візерунка та введіть вираз.
   - **Одинарний файл .csv або .паркету**: перейдіть до файлу .csv або .паркету та виберіть його.

   :::image type="content" source="media/ADLS_new_entity_location.png" alt-text="Діалогове вікно для створення нової сутності з виділеним розташуванням файлів даних.":::

1. Виберіть **Зберегти**.

   :::image type="content" source="media/ADLS_new_entity_define_attributes.png" alt-text="Діалогове вікно для визначення або автоматичного створення атрибутів.":::

1. Виберіть прапорець **визначити атрибути**, щоб вручну додати атрибути, або виберіть автоматичне **їх** створення. Щоб визначити атрибути, введіть ім'я, виберіть формат даних і необов'язковий семантичний тип. Для автоматично створених атрибутів:

   1. Після автоматичного створення атрибутів виберіть елемент **Атрибути** рецензування. Відобразиться **сторінка "Керування атрибутами** ".

   1. Переконайтеся, що формат даних правильний для кожного атрибута.

   1. Щоб увімкнути аналітику та інші можливості, виберіть елемент **Профілювання** даних для всієї сутності або для певних атрибутів. За замовчуванням для профілювання даних не ввімкнуто жодної сутності.

      :::image type="content" source="media/dataprofiling-entities.png" alt-text="Діалогове вікно для вибору профілювання даних.":::

   1. Виберіть **Готово**. Відобразиться **сторінка "Виділення сутностей** ".

1. Продовжуйте додавати сутності та атрибути, якщо це можливо.

1. Після того, як всі сутності будуть додані, виберіть **"Включити"**, щоб включити сутності в джерело даних прийом всередину.

   :::image type="content" source="media/ADLS_required.png" alt-text="Діалогове вікно &quot;Обов'язкове для первинного ключа&quot;":::

1. Для вибраних сутностей, які потребують інкрементного прийому всередину, **обов'язкове** відображення в розділі **Поступове оновлення**. Для кожної з цих сутностей перегляньте статтю [Настроювання поступового оновлення для джерел даних Azure Data Lake](incremental-refresh-data-sources.md).

1. Для вибраних сутностей, де первинний ключ не визначено, **обов'язкове** відображення відображається в розділі **Первинний ключ**. Для кожного з цих суб'єктів:
   1. Виберіть обов'язковий **.** Відобразиться **панель "Редагувати сутність** ".
   1. Виберіть первинний **ключ**. Первинний ключ є атрибутом, унікальним для сутності. Атрибут, який має стати дійсним первинним ключем, не повинен мати повторюваних значень, відсутніх значень або значень null. Атрибути типу даних String, Integer і GUID підтримуються як первинні ключі.
   1. За потреби змініть шаблон розділу.
   1. Виберіть " **Закрити"**, щоб зберегти та закрити панель.

1. Виберіть **Зберегти**. Відкриється **сторінка Джерела** даних із новим джерело даних у **стані оновлення**.


## <a name="edit-an-azure-data-lake-storage-data-source"></a>Azure Data Lake Storage Редагування джерело даних

Ви можете оновити обліковий *запис Підключитися до сховища за допомогою* опції. Для отримання додаткової інформації перегляньте статтю [Підключення Customer Insights до облікового Azure Data Lake Storage запису Gen2 за допомогою принципу](connect-service-principal.md) обслуговування Azure. Щоб підключитися до іншого контейнера зі свого облікового запису сховища або змінити ім’я облікового запису, [створіть нове підключення до джерела даних](#connect-to-azure-data-lake-storage).

1. Відкрийте **Дані** > **Джерела даних**.

1. Поруч із джерело даних, які потрібно оновити, натисніть кнопку **Редагувати**.

   :::image type="content" source="media/data_sources_edit_ADLS.png" alt-text="Діалогове вікно для редагування джерело даних Azure Data Lake.":::

1. Змініть будь-яку з наведених нижче відомостей.

   - **Опис**
   - **Підключіть сховище, використовуючи** інформацію про підключення та з'єднання. Під час оновлення з'єднання інформацію про **Контейнер** змінити не можна.
      > [!NOTE]
      > Для облікового запису або контейнера сховища має бути призначена одна з таких ролей:
        > - Зчитувач даних BLOB-об'єктів сховища
        > - Відповідальний для BLOB-об'єктів сховища
        > - Постачальник даних BLOB-об’єктів сховища

   - **Увімкніть приватне посилання**, якщо ви хочете отримати дані з облікового запису сховища через приватне посилання Azure. Для отримання додаткової інформації дивіться [Приватні посилання](security-overview.md#private-links-tab).

1. Виберіть **Далі**.
1. Змініть будь-яку з наведених нижче дій.
   - Перейдіть до іншого файлу model.json або manifest.json з іншим набором сутностей від контейнера.
   - Щоб додати додаткові сутності до прийому всередину, виберіть елемент **Нова сутність**.
   - Щоб видалити вже виділені сутності, якщо немає залежностей, виберіть сутність і **Видалити**.
      > [!IMPORTANT]
      > Якщо існують залежності від наявного файлу model.json або manifest.json і набору сутностей, ви побачите повідомлення про помилку та не зможете вибрати інший файл model.json або manifest.json. Усуньте ці залежності перед тим, як змінювати файл model.json або manifest.json, або ж створіть нове джерело даних з файлом model.json або manifest.json, який потрібно використовувати, щоб уникнути усунення залежностей.
   - Щоб змінити розташування файлу даних або первинний ключ, натисніть кнопку **Редагувати**.
   - Щоб змінити інкрементні дані проковтування, перегляньте статтю [Настроювання поступового оновлення джерел даних Azure Data Lake](incremental-refresh-data-sources.md)

1. Виберіть " **Атрибути** ", щоб додати або змінити атрибути, або ввімкнути профілювання даних. Потім натисніть **Готово**.

1. Натисніть кнопку **Зберегти**, щоб застосувати зміни та повернутися на сторінку **Джерела** даних.
